<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="Gute Absichten">
<meta name="viewport" content="width=device-width">
<title>Merge and Destroy (old posts, page 2) | Merge and Destroy</title>
<link href="../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link rel="alternate" type="application/rss+xml" title="RSS (de)" href="../rss.xml">
<link rel="alternate" type="application/rss+xml" title="RSS (en)" href="rss.xml">
<link rel="canonical" href="https://encarsia.github.io/en/index-2.html">
<!--[if lt IE 9]><script src="/assets/js/html5.js"></script><![endif]-->
</head>
<body>
    <section class="social"><ul>
<li><a href="../index.html" title="Home"><i class="icon-home"></i></a></li>
            <li><a href="../categories/index.html" title="Tags"><i class="icon-tags"></i></a></li>
            <li><a href="../rss.xml" title="RSS"><i class="icon-rss"></i></a></li>
            <li><a href="https://plus.google.com/105146352752269764996/posts" title="Google+"><i class="icon-google-plus"></i></a></li>
            <li><a href="https://github.com/encarsia" title="Github"><i class="icon-github"></i></a></li>
            <li><a href="https://twitter.com/encarsia_" title="Twitter"><i class="icon-twitter"></i></a></li>
            <li><a href="../pages/about/index.html" title="About me"><i class="icon-user"></i></a></li>
            <li><a href="../archive.html" title="Archives"><i class="icon-folder-open-alt"></i></a></li>

        </ul></section><section class="page-content"><div class="content" rel="main">
            
        <div class="post">
            <h1 class="title"><a href="posts/ansichtssache/">Data view</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2016-12-22T00:02:20+01:00">2016-12-22 00:02</time>
</div>
                <div class="stats">
                    
        
    <a href="posts/ansichtssache/#disqus_thread" data-disqus-identifier="cache/posts/ansichtssache.html">Comments</a>


                </div>
            
        <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/glade/" rel="tag">glade</a></li>
           <li><a class="tag p-category" href="categories/python/" rel="tag">python</a></li>
        </ul>
</div>

            </div>
            <div class="body">
                <div>
<div class="contents warning pull-right topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="posts/ansichtssache/#treestore-vs-liststore" id="id5">TreeStore vs. ListStore</a></li>
<li>
<a class="reference internal" href="posts/ansichtssache/#glade" id="id6">Glade</a><ul>
<li><a class="reference internal" href="posts/ansichtssache/#treemodelsort" id="id7">TreeModelSort</a></li>
<li><a class="reference internal" href="posts/ansichtssache/#treemodelfilter" id="id8">TreeModelFilter</a></li>
<li><a class="reference internal" href="posts/ansichtssache/#load-formatting-values-from-the-model" id="id9">Load formatting values from the model</a></li>
</ul>
</li>
<li>
<a class="reference internal" href="posts/ansichtssache/#python" id="id10">Python</a><ul>
<li><a class="reference internal" href="posts/ansichtssache/#id1" id="id11">TreeModelSort</a></li>
<li><a class="reference internal" href="posts/ansichtssache/#id2" id="id12">TreeModelFilter</a></li>
</ul>
</li>
<li>
<a class="reference internal" href="posts/ansichtssache/#listings" id="id13">Listings</a><ul>
<li><a class="reference internal" href="posts/ansichtssache/#id3" id="id14">Glade</a></li>
<li><a class="reference internal" href="posts/ansichtssache/#id4" id="id15">Python</a></li>
</ul>
</li>
</ul>
</div>
<p><strong>Display TreeStore data</strong></p>
<p>(Continuation of the <a class="reference external" href="posts/uberlistet">ListStore article</a>)</p>
<a class="reference external image-reference" href="../images/12_treestore.png"><img alt="/images/12_treestore.thumbnail.png" src="../images/12_treestore.thumbnail.png" style="width: 480px;"></a>
<div class="section" id="treestore-vs-liststore">
<h2><a class="toc-backref" href="posts/ansichtssache/#id5">TreeStore vs. ListStore</a></h2>
<p>In contrast to ListStores TreeStore rows can possess child rows. That's why the <tt class="docutils literal">append</tt> function requires another parameter that specifies the parent row reference:</p>
<pre class="code python"><a name="rest_code_be45f229e1c845ddb0afb64775f695f5-1"></a><span class="c1">#append row to liststore</span>
<a name="rest_code_be45f229e1c845ddb0afb64775f695f5-2"></a><span class="n">store</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">value1</span><span class="p">,</span><span class="n">value2</span><span class="p">,</span><span class="n">value3</span><span class="p">])</span>
<a name="rest_code_be45f229e1c845ddb0afb64775f695f5-3"></a>
<a name="rest_code_be45f229e1c845ddb0afb64775f695f5-4"></a><span class="c1">#append row to treestore</span>
<a name="rest_code_be45f229e1c845ddb0afb64775f695f5-5"></a><span class="n">store</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">parent</span><span class="p">,[</span><span class="n">value1</span><span class="p">,</span><span class="n">value2</span><span class="p">,</span><span class="n">value3</span><span class="p">])</span>
</pre>
<p>The <em>parent</em> value is either</p>
<ul class="simple">
<li>
<strong>None</strong> if the current row is not a child row of another, or</li>
<li>
<strong>TreeIter</strong> pointing to the superordinate row.</li>
</ul>
<p>The <em>TreeIter</em> value is generated when creating a row, subordinate rows are created by</p>
<pre class="code python"><a name="rest_code_7ba0d6a25bf0441f8deb3d077efa344f-1"></a><span class="n">row1</span> <span class="o">=</span> <span class="n">store</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">None</span><span class="p">,[</span><span class="n">value1</span><span class="p">,</span><span class="n">value2</span><span class="p">,</span><span class="n">value3</span><span class="p">])</span>
<a name="rest_code_7ba0d6a25bf0441f8deb3d077efa344f-2"></a><span class="n">row2</span> <span class="o">=</span> <span class="n">store</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row1</span><span class="p">,[</span><span class="n">value1</span><span class="p">,</span><span class="n">value2</span><span class="p">,</span><span class="n">value3</span><span class="p">])</span>
</pre>
<p>The TreeIter of a cell is obtained by calling the <tt class="docutils literal">get_selection</tt> function of the automatically generated <em>GtkTreeSelection</em> widget.</p>
</div>
<div class="section" id="glade">
<h2><a class="toc-backref" href="posts/ansichtssache/#id6">Glade</a></h2>
<p>In the example there are two TreeStores with some columns and the coresponding TreeView widgets to display the data columns.</p>
<div class="section" id="treemodelsort">
<h3><a class="toc-backref" href="posts/ansichtssache/#id7">TreeModelSort</a></h3>
<p>Sorting a column is set by calling <tt class="docutils literal">set_sort_column_id</tt>. If this is applied to the TreeStore all TreeView widgets using this store are equally sorted.</p>
<p>If this behaviour is not diesired <em>TreeModelSort</em> elements come into play and which are "interposed" between store and view widgets. First the TreeModelSort is created via <em>"Miscellaneous &gt; Tree Model Sort"</em> from the widget sidebar. Then you choose a source TreeView to use data from. After that the model in the TreeView widget is replaced by the newly created TreeModelSort.</p>
<p>The sort function is now simply applied to the TreeModelSort object instead to the TreeView object.</p>
</div>
<div class="section" id="treemodelfilter">
<h3><a class="toc-backref" href="posts/ansichtssache/#id8">TreeModelFilter</a></h3>
<p><em>TreeModelFilter</em> allows to only show data that matches the specified filter criteria. Handling this object is analogue to TreeModelSort.</p>
<p>In the example the varieties can be filtered according to fruit colour so there is a <em>GtkButtonBox</em> required to put the corresponding buttons into.</p>
</div>
<div class="section" id="load-formatting-values-from-the-model">
<h3><a class="toc-backref" href="posts/ansichtssache/#id9">Load formatting values from the model</a></h3>
<p>Besides the columns containing displayed data there is a "weight" column in the first TreeStore. This value is used to show the cell in bold text. It is realized by setting the CellRenderer's property of <em>"Font weight"</em> to the column containing the corresponding value (normal font is 400). In this way the appearance of cells can be defined, for example colours or font formating.</p>
</div>
</div>
<div class="section" id="python">
<h2><a class="toc-backref" href="posts/ansichtssache/#id10">Python</a></h2>
<div class="section" id="id1">
<h3><a class="toc-backref" href="posts/ansichtssache/#id11">TreeModelSort</a></h3>
<p>Requesting a position by calling <tt class="docutils literal">GtkTreeSelection.get_selected()</tt> returns a tuple (model, pos), <em>pos</em> of <em>model</em> points to TreeModelSort (or TreeModelFilter) and requires conversion to the TreeStore position:</p>
<pre class="code python"><a name="rest_code_4f1db1304374497cbc0580a32846ce9d-1"></a><span class="n">model</span><span class="p">,</span><span class="n">pos</span> <span class="o">=</span> <span class="n">selection</span><span class="o">.</span><span class="n">get_selected</span><span class="p">()</span>
<a name="rest_code_4f1db1304374497cbc0580a32846ce9d-2"></a><span class="n">converted_iter</span> <span class="o">=</span> <span class="n">treesort</span><span class="o">.</span><span class="n">convert_iter_to_child_iter</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
<a name="rest_code_4f1db1304374497cbc0580a32846ce9d-3"></a><span class="n">store</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">converted_iter</span><span class="p">,</span><span class="n">column</span><span class="p">,</span><span class="n">value</span><span class="p">)</span>
</pre>
</div>
<div class="section" id="id2">
<h3><a class="toc-backref" href="posts/ansichtssache/#id12">TreeModelFilter</a></h3>
<p>First of all a filter function is required defining the visibility of cells, in the example it's the variable <em>self.color</em>:</p>
<pre class="code python"><a name="rest_code_64ed9714f7064d27b88d070ed54c3a0a-1"></a><span class="k">def</span> <span class="nf">color_filter_func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">model</span><span class="p">,</span><span class="nb">iter</span><span class="p">,</span><span class="n">data</span><span class="p">):</span>
<a name="rest_code_64ed9714f7064d27b88d070ed54c3a0a-2"></a>    <span class="k">if</span> <span class="n">model</span><span class="p">[</span><span class="nb">iter</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">color</span><span class="p">:</span>
<a name="rest_code_64ed9714f7064d27b88d070ed54c3a0a-3"></a>        <span class="k">return</span> <span class="bp">True</span>
<a name="rest_code_64ed9714f7064d27b88d070ed54c3a0a-4"></a>    <span class="k">else</span><span class="p">:</span>
<a name="rest_code_64ed9714f7064d27b88d070ed54c3a0a-5"></a>        <span class="k">return</span> <span class="bp">False</span>
</pre>
<p>This function has to be assigned to TreeFilter</p>
<pre class="code python"><a name="rest_code_f377f028a42140358098d4f6d137289e-1"></a><span class="n">treefilter</span><span class="o">.</span><span class="n">set_visible_func</span><span class="p">(</span><span class="n">filter_func</span><span class="p">)</span>
</pre>
<p>A filter process is then executed by calling the <tt class="docutils literal">refilter()</tt> function on the TreeFilter object:</p>
<pre class="code python"><a name="rest_code_7f44afa7424942b392044b735e45fbb0-1"></a><span class="k">def</span> <span class="nf">on_button_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">widget</span><span class="p">):</span>
<a name="rest_code_7f44afa7424942b392044b735e45fbb0-2"></a>    <span class="n">x</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">widget</span><span class="o">.</span><span class="n">get_label</span><span class="p">()</span>
<a name="rest_code_7f44afa7424942b392044b735e45fbb0-3"></a>    <span class="n">x</span><span class="o">.</span><span class="n">obj</span><span class="p">(</span><span class="s2">"treefilter"</span><span class="p">)</span><span class="o">.</span><span class="n">refilter</span><span class="p">()</span>
</pre>
<p class="more"><a href="posts/ansichtssache/">Read more…</a></p>
</div>
</div>
</div>
            </div>
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/neues-projekt-knights-of-ni/">New project: Knights of Ni</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2016-12-11T17:57:35+01:00">2016-12-11 17:57</time>
</div>
                <div class="stats">
                    
        
    <a href="posts/neues-projekt-knights-of-ni/#disqus_thread" data-disqus-identifier="cache/posts/neues-projekt-knights-of-ni.html">Comments</a>


                </div>
            
        <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/glade/" rel="tag">glade</a></li>
           <li><a class="tag p-category" href="categories/nikola/" rel="tag">nikola</a></li>
           <li><a class="tag p-category" href="categories/python/" rel="tag">python</a></li>
        </ul>
</div>

            </div>
            <div class="body">
                <div>
<p><strong>Knights of Ni - small managing tool for the static website generator Nikola</strong></p>
<a class="reference external image-reference" href="../images/non_window.png"><img alt="/images/non_window.thumbnail.png" src="../images/non_window.thumbnail.png"></a>
<p>New little project made of Glade and Python on GitHub: <a class="reference external" href="https://github.com/encarsia/non">Knights of Ni</a>.</p>
</div>
            </div>
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/exterminate/">Exterminate!</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2016-11-30T15:48:06+01:00">2016-11-30 15:48</time>
</div>
                <div class="stats">
                    
        
    <a href="posts/exterminate/#disqus_thread" data-disqus-identifier="cache/posts/exterminate.html">Comments</a>


                </div>
            
        <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/glade/" rel="tag">glade</a></li>
           <li><a class="tag p-category" href="categories/python/" rel="tag">python</a></li>
        </ul>
</div>

            </div>
            <div class="body">
                <div>
<div class="contents warning pull-right topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="posts/exterminate/#glade" id="id5">Glade</a></li>
<li><a class="reference internal" href="posts/exterminate/#python" id="id6">Python</a></li>
<li>
<a class="reference internal" href="posts/exterminate/#listings" id="id7">Listings</a><ul>
<li><a class="reference internal" href="posts/exterminate/#id3" id="id8">Glade</a></li>
<li><a class="reference internal" href="posts/exterminate/#id4" id="id9">Python</a></li>
</ul>
</li>
</ul>
</div>
<p><strong>The VTE terminal widget</strong></p>
<a class="reference external image-reference" href="../images/11_terminal.png"><img alt="/images/11_terminal.thumbnail.png" src="../images/11_terminal.thumbnail.png"></a>
<div class="section" id="glade">
<h2><a class="toc-backref" href="posts/exterminate/#id5">Glade</a></h2>
<p>The widget can be found in the lower part of the widget side bar and provides a complete terminal emulator. To close the window on the <tt class="docutils literal">exit</tt> command the <em>child-exited</em> signal has to be assigned.</p>
<p>A button click shall open a Python prompt within the terminal window, so we need the familiar <em>clicked</em> signal.</p>
</div>
<div class="section" id="python">
<h2><a class="toc-backref" href="posts/exterminate/#id6">Python</a></h2>
<p>Elements used in Glade that are not part of the <em>Gtk</em> module have to be registered as a <em>GObject</em> object (this is also required when using a <em>GtkSourceView</em> widget as the functionality is provided by the <a href="posts/exterminate/#id1"><span class="problematic" id="id2">*</span></a>GtkSource module):</p>
<div class="system-message" id="id1">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">&lt;string&gt;</tt>, line 19); <em><a href="posts/exterminate/#id2">backlink</a></em></p>
Inline emphasis start-string without end-string.</div>
<pre class="code python"><a name="rest_code_959be446af7c48b9a88af6a8d081ffd6-1"></a><span class="n">GObject</span><span class="o">.</span><span class="n">type_register</span><span class="p">(</span><span class="n">Vte</span><span class="o">.</span><span class="n">Terminal</span><span class="p">)</span>
</pre>
<p>The terminal emulator is initiated by calling <tt class="docutils literal">spawn_sync</tt> expecting 7 parameters. Detailed information on the parameters are available in the <a class="reference external" href="https://lazka.github.io/pgi-docs/#Vte-2.91/classes/Terminal.html#Vte.Terminal.spawn_sync">documentation</a> but for a common start a lot of defaults and Nones will do:</p>
<pre class="code python"><a name="rest_code_76e1b49acda346f79ad56329d94eec36-1"></a><span class="n">terminal</span><span class="o">.</span><span class="n">spawn_sync</span><span class="p">(</span>
<a name="rest_code_76e1b49acda346f79ad56329d94eec36-2"></a>        <span class="n">Vte</span><span class="o">.</span><span class="n">PtyFlags</span><span class="o">.</span><span class="n">DEFAULT</span><span class="p">,</span>
<a name="rest_code_76e1b49acda346f79ad56329d94eec36-3"></a>        <span class="bp">None</span><span class="p">,</span>
<a name="rest_code_76e1b49acda346f79ad56329d94eec36-4"></a>        <span class="p">[</span><span class="s2">"/bin/bash"</span><span class="p">],</span>
<a name="rest_code_76e1b49acda346f79ad56329d94eec36-5"></a>        <span class="bp">None</span><span class="p">,</span>
<a name="rest_code_76e1b49acda346f79ad56329d94eec36-6"></a>        <span class="n">GLib</span><span class="o">.</span><span class="n">SpawnFlags</span><span class="o">.</span><span class="n">DEFAULT</span><span class="p">,</span>
<a name="rest_code_76e1b49acda346f79ad56329d94eec36-7"></a>        <span class="bp">None</span><span class="p">,</span>
<a name="rest_code_76e1b49acda346f79ad56329d94eec36-8"></a>        <span class="bp">None</span><span class="p">,</span>
<a name="rest_code_76e1b49acda346f79ad56329d94eec36-9"></a>        <span class="p">)</span>
</pre>
<p>The <tt class="docutils literal">feed_child</tt> function must be called to send a command to the console. The expected parameters are the string including a newline and the length of the string:</p>
<pre class="code python"><a name="rest_code_8a7bfb5ae0744521a207638967e90674-1"></a><span class="n">command</span> <span class="o">=</span> <span class="s2">"python</span><span class="se">\n</span><span class="s2">"</span>
<a name="rest_code_8a7bfb5ae0744521a207638967e90674-2"></a><span class="n">x</span><span class="o">.</span><span class="n">terminal</span><span class="o">.</span><span class="n">feed_child</span><span class="p">(</span><span class="n">command</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">command</span><span class="p">))</span>
</pre>
<p class="more"><a href="posts/exterminate/">Read more…</a></p>
</div>
</div>
            </div>
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/youniversity-transforming-python-code/">YouNiversity: Transforming Code into Beautiful, Idiomatic Python</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2016-11-29T12:30:03+01:00">2016-11-29 12:30</time>
</div>
                <div class="stats">
                    
        
    <a href="posts/youniversity-transforming-python-code/#disqus_thread" data-disqus-identifier="cache/posts/youniversity-transforming-code-into-beautiful-idiomatic-python.html">Comments</a>


                </div>
            
        <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/python/" rel="tag">python</a></li>
           <li><a class="tag p-category" href="categories/video/" rel="tag">video</a></li>
           <li><a class="tag p-category" href="categories/youtube/" rel="tag">youtube</a></li>
        </ul>
</div>

            </div>
            <div class="body">
                <div class="youtube-video">
<iframe width="480" height="344" src="https://www.youtube.com/embed/OSGv2VnC0go?rel=0&amp;hd=1&amp;wmode=transparent"></iframe>
</div>
            </div>
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/romani-ite-domum/">Romani ite domum</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2016-11-28T14:50:22+01:00">2016-11-28 14:50</time>
</div>
                <div class="stats">
                    
        
    <a href="posts/romani-ite-domum/#disqus_thread" data-disqus-identifier="cache/posts/romani-ite-domum.html">Comments</a>


                </div>
            
        <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/glade/" rel="tag">glade</a></li>
           <li><a class="tag p-category" href="categories/python/" rel="tag">python</a></li>
        </ul>
</div>

            </div>
            <div class="body">
                <div>
<div class="contents warning pull-right topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="posts/romani-ite-domum/#glade" id="id4">Glade</a></li>
<li>
<a class="reference internal" href="posts/romani-ite-domum/#python" id="id5">Python</a><ul>
<li><a class="reference internal" href="posts/romani-ite-domum/#translatable-strings" id="id6">Translatable strings</a></li>
<li><a class="reference internal" href="posts/romani-ite-domum/#configure-bind-textdomain" id="id7">configure (bind)textdomain</a></li>
</ul>
</li>
<li>
<a class="reference internal" href="posts/romani-ite-domum/#gettext" id="id8">GetText</a><ul>
<li><a class="reference internal" href="posts/romani-ite-domum/#pot" id="id9">POT</a></li>
<li><a class="reference internal" href="posts/romani-ite-domum/#po" id="id10">PO</a></li>
<li><a class="reference internal" href="posts/romani-ite-domum/#mo" id="id11">MO</a></li>
</ul>
</li>
<li>
<a class="reference internal" href="posts/romani-ite-domum/#listings" id="id12">Listings</a><ul>
<li><a class="reference internal" href="posts/romani-ite-domum/#id1" id="id13">Glade</a></li>
<li><a class="reference internal" href="posts/romani-ite-domum/#id2" id="id14">Python</a></li>
<li><a class="reference internal" href="posts/romani-ite-domum/#id3" id="id15">POT</a></li>
</ul>
</li>
</ul>
</div>
<p><strong>Localization with gettext and locale</strong></p>
<a class="reference external image-reference" href="../images/10_lokalisation.png"><img alt="/images/10_lokalisation.thumbnail.png" src="../images/10_lokalisation.thumbnail.png"></a>
<div class="section" id="glade">
<h2><a class="toc-backref" href="posts/romani-ite-domum/#id4">Glade</a></h2>
<p>Strings in widgets are by default configurated as translatable so there are no preparations required. GetText directly provercesses Glade project files.</p>
</div>
<div class="section" id="python">
<h2><a class="toc-backref" href="posts/romani-ite-domum/#id5">Python</a></h2>
<div class="section" id="translatable-strings">
<h3><a class="toc-backref" href="posts/romani-ite-domum/#id6">Translatable strings</a></h3>
<p>Approved translatable strings are recognized by <tt class="docutils literal">xgettext</tt> by brackets with a leading underscore:</p>
<pre class="code python"><a name="rest_code_827d6b8d2e464eddbb6cf61b2d338b48-1"></a><span class="n">_</span> <span class="o">=</span> <span class="n">gettext</span><span class="o">.</span><span class="n">gettext</span>
<a name="rest_code_827d6b8d2e464eddbb6cf61b2d338b48-2"></a><span class="n">translatable_string</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s2">"translate me"</span><span class="p">)</span>
</pre>
</div>
<div class="section" id="configure-bind-textdomain">
<h3><a class="toc-backref" href="posts/romani-ite-domum/#id7">configure (bind)textdomain</a></h3>
<p>Now name and location of the MO files have to be configured in the source code:</p>
<pre class="code python"><a name="rest_code_fb9e3252bdc34217a870df464a9eacb8-1"></a><span class="n">locale</span><span class="o">.</span><span class="n">bindtextdomain</span><span class="p">(</span><span class="n">appname</span><span class="p">,</span><span class="n">locales_dir</span><span class="p">)</span>
<a name="rest_code_fb9e3252bdc34217a870df464a9eacb8-2"></a><span class="n">locale</span><span class="o">.</span><span class="n">textdomain</span><span class="p">(</span><span class="n">locales_dir</span><span class="p">)</span>
<a name="rest_code_fb9e3252bdc34217a870df464a9eacb8-3"></a><span class="n">gettext</span><span class="o">.</span><span class="n">bindtextdomain</span><span class="p">(</span><span class="n">appname</span><span class="p">,</span><span class="n">locales_dir</span><span class="p">)</span>
<a name="rest_code_fb9e3252bdc34217a870df464a9eacb8-4"></a><span class="n">gettext</span><span class="o">.</span><span class="n">textdomain</span><span class="p">(</span><span class="n">appname</span><span class="p">)</span>
<a name="rest_code_fb9e3252bdc34217a870df464a9eacb8-5"></a><span class="n">builder</span><span class="o">.</span><span class="n">set_translation_domain</span><span class="p">(</span><span class="n">appname</span><span class="p">)</span>
</pre>
<p><tt class="docutils literal">set_translation_domain</tt> has to be called before loading Glade files.</p>
</div>
</div>
<div class="section" id="gettext">
<h2><a class="toc-backref" href="posts/romani-ite-domum/#id8">GetText</a></h2>
<div class="section" id="pot">
<h3><a class="toc-backref" href="posts/romani-ite-domum/#id9">POT</a></h3>
<p>POT is the abbrevation for Portable Object Template. This file contains all original translatable strings. After generating an empty POT file, <tt class="docutils literal">xgettext</tt> is executed for all source files containing translatable strings:</p>
<pre class="code console"><a name="rest_code_8faf48fa6f714737b2625c868dd44356-1"></a><span class="gp">$</span> xgettext --options -o output.pot sourcefile.ext
</pre>
<p>The identified strings are added to the POT file.</p>
<pre class="code console"><a name="rest_code_2528dcee055b43f1848a775e081b610c-1"></a><span class="gp">#</span>: sourcefile.ext:line number
<a name="rest_code_2528dcee055b43f1848a775e081b610c-2"></a><span class="go">msgid "translatable string"</span>
<a name="rest_code_2528dcee055b43f1848a775e081b610c-3"></a><span class="go">msgstr ""</span>
</pre>
<p>The file number reference comment can be avoided by passting the option <tt class="docutils literal"><span class="pre">--no-location</span></tt>.</p>
<p>In this article's example it is required to run xgettext once for the Glade file and once for the Python source code; the <tt class="docutils literal"><span class="pre">-j</span></tt> (<tt class="docutils literal"><span class="pre">--join-existing</span></tt>) option adds new found strings to an existing file:</p>
<pre class="code console"><a name="rest_code_86d44409a67842ff86d5507d36f7d94a-1"></a><span class="gp">$</span> xgettext --sort-output --keyword<span class="o">=</span>translatable --language<span class="o">=</span>Glade -j -o 10_localization/TUT.pot 10_lokalisation.glade
<a name="rest_code_86d44409a67842ff86d5507d36f7d94a-2"></a><span class="gp">$</span> xgettext --language<span class="o">=</span>Python -j -o 10_localization/TUT.pot 10_lokalisation.py
</pre>
</div>
<div class="section" id="po">
<h3><a class="toc-backref" href="posts/romani-ite-domum/#id10">PO</a></h3>
<p>Translated strings are stored in a PO file per language. A new translation ist invoked by</p>
<pre class="code console"><a name="rest_code_8c6ea5f4ee5e4b3481b82e3de3ad056d-1"></a><span class="gp">$</span> msginit --input<span class="o">=</span>source.pot --locale<span class="o">=</span>xx
<a name="rest_code_8c6ea5f4ee5e4b3481b82e3de3ad056d-2"></a><span class="gp">#</span> <span class="nv">xx</span><span class="o">=</span>language code
</pre>
<p>that generates a file after the pattern xx.po (p.e. de.po). This file can be edited in any text editor or dedicated tools such like <a class="reference external" href="https://poedit.net/">PoEdit</a>. A German localization for example is created by the command</p>
<pre class="code console"><a name="rest_code_7a8cb392dcf0496ab15d20995b00122c-1"></a><span class="gp">$</span> msginit --input<span class="o">=</span>TUT.pot --locale<span class="o">=</span>de
</pre>
<p>If the POT file is altered the PO files are updated with the new strings by executing <tt class="docutils literal">msgmerge</tt>:</p>
<pre class="code console"><a name="rest_code_031a254c3b874273a75588c5f45b2f08-1"></a><span class="gp">$</span> msgmerge lang.po template.pot &gt; new_lang.po
</pre>
</div>
<div class="section" id="mo">
<h3><a class="toc-backref" href="posts/romani-ite-domum/#id11">MO</a></h3>
<p>MO files are (machine readable) binary files and mandatory for gettext to work. Localization files are located below the <em>bindtextdomain</em> following the file structure <tt class="docutils literal"><span class="pre">path/to/bindtextdomain)/locale/language</span> code/LC_MESSAGES/appname.po</tt>.</p>
<p>In the example the bindtextdomain is created in the local directory, the generated <cite>de.po</cite> translation text file then transformed into the  corresponding MO file:</p>
<pre class="code console"><a name="rest_code_eee09a53df844477899d1af95d164468-1"></a><span class="gp">$</span> msgfmt --output locale/de/LC_MESSAGES/TUT.mo de.po
</pre>
<p class="more"><a href="posts/romani-ite-domum/">Read more…</a></p>
</div>
</div>
</div>
            </div>
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/uberlistet/">ListStore</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2016-11-24T17:55:14+01:00">2016-11-24 17:55</time>
</div>
                <div class="stats">
                    
        
    <a href="posts/uberlistet/#disqus_thread" data-disqus-identifier="cache/posts/uberlistet.html">Comments</a>


                </div>
            
        <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/glade/" rel="tag">glade</a></li>
           <li><a class="tag p-category" href="categories/python/" rel="tag">python</a></li>
        </ul>
</div>

            </div>
            <div class="body">
                <div>
<div class="contents warning pull-right topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li>
<a class="reference internal" href="posts/uberlistet/#glade" id="id6">Glade</a><ul>
<li><a class="reference internal" href="posts/uberlistet/#liststore" id="id7">ListStore</a></li>
<li><a class="reference internal" href="posts/uberlistet/#widgets" id="id8">Widgets</a></li>
</ul>
</li>
<li>
<a class="reference internal" href="posts/uberlistet/#python" id="id9">Python</a><ul>
<li><a class="reference internal" href="posts/uberlistet/#treestore" id="id10">TreeStore</a></li>
<li><a class="reference internal" href="posts/uberlistet/#combobox" id="id11">ComboBox</a></li>
<li><a class="reference internal" href="posts/uberlistet/#edit-cells" id="id12">Edit cells</a></li>
</ul>
</li>
<li>
<a class="reference internal" href="posts/uberlistet/#listings" id="id13">Listings</a><ul>
<li><a class="reference internal" href="posts/uberlistet/#id4" id="id14">Glade</a></li>
<li><a class="reference internal" href="posts/uberlistet/#id5" id="id15">Python</a></li>
</ul>
</li>
</ul>
</div>
<p><strong>Store data sets in ListStores and use ComboBox and TreeView to display the data</strong></p>
<p>There are a bunch of elements required to store and display tables of data in GTK+ applications:</p>
<ol class="arabic simple">
<li><dl class="first docutils">
<dt>The model to administrate data. There are two types:</dt>
<dd><ul class="first last">
<li>
<em>ListStore:</em> flat table, besides string and numerical values the rows also can be of GTK+ element type (like buttons or checkboxes), input of data sets in Glade possible</li>
<li>
<em>TreeStore:</em> just like ListStore but rows can possess child rows, input of data sets in Glade is not possible (see also <a class="reference external" href="posts/ansichtssache">TreeStore article</a>)</li>
</ul></dd>
</dl></li>
<li><dl class="first docutils">
<dt>Widgets:</dt>
<dd><ul class="first last">
<li>
<em>TreeView:</em> show, sort and edit data; used by both store model types; a data store can be used my multiple TreeView widgets</li>
<li>
<em>ComboBox:</em> comboboxes are used to limit input to given list items, this list can be stored in a List/TreeStore (see also <a class="reference external" href="posts/qual-der-wahl">spinbutton and combobox article</a>)</li>
<li>
<em>CellRenderers:</em> Subwidgets to specify source, layout and other properties (like being editable) of displayed data rows</li>
</ul></dd>
</dl></li>
</ol>
<a class="reference external image-reference" href="../images/09_treestore2.png"><img alt="/images/09_treestore2.thumbnail.png" src="../images/09_treestore2.thumbnail.png"></a>
<div class="section" id="glade">
<h2><a class="toc-backref" href="posts/uberlistet/#id6">Glade</a></h2>
<div class="section" id="liststore">
<h3><a class="toc-backref" href="posts/uberlistet/#id7">ListStore</a></h3>
<p>In the example there is one ListStore created via <em>"Miscellaneous &gt; List Store"</em> which will be later used by three Widgets.</p>
<p>First there are some rows created. ListStore data sets can be inserted in Glade but this in practise is only convenient for typing in few data sets.</p>
<p>Content changes in the ListStore are simultaneously updated in the Widgets using the ListStore. For individual sorting of the same List/TreeStore it is needed to create <em>Gtk.TreeModelSort</em> elements (this element is used in the example of the <a class="reference external" href="posts/ansichtssache">TreeStore article</a>).</p>
<a class="reference external image-reference" href="../images/09_treestore1.png"><img alt="/images/09_treestore1.thumbnail.png" src="../images/09_treestore1.thumbnail.png"></a>
</div>
<div class="section" id="widgets">
<h3><a class="toc-backref" href="posts/uberlistet/#id8">Widgets</a></h3>
<dl class="docutils">
<dt>ComboBox</dt>
<dd>Creating the widget you are prompted to choose as "TreeView Model". In the edit mode accessible via <em>"Edit &gt; Hierarchy"</em> there is created a CellRendererText. In the first field ("Text") the column to load the items of the dropdown menu from is set. To process the selection you will need the <em>changed</em> signal.</dd>
<dt>TreeView #1</dt>
<dd>The first TreeView widget is placed within a <em>Gtk.ScrolledWindow</em> container. Like in a ComboBox there are created CellRenderer representing a column to show in the TreeView table. If the sort indicator is activated columns can be sorted on a column table click.
Columns do not have to be sorted according to the columns they show.</dd>
<dt>TreeView #2</dt>
<dd>
<p class="first">The second TreeView widget is created within a <em>Gtk.ViewPort</em>. This container widget does not provide scroll bars but the automatically adapts the necessary size to display the whole content. So for larger tables you will need the <em>Gtk.ScrolledWindow</em>.
The sort indicator is deactivated and the middle column ("Description") is made editible with the signal <a href="posts/uberlistet/#id2"><span class="problematic" id="id3">*</span></a>edited" allocated.</p>
<div class="last system-message" id="id2">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">&lt;string&gt;</tt>, line 45); <em><a href="posts/uberlistet/#id3">backlink</a></em></p>
Inline emphasis start-string without end-string.</div>
</dd>
<dt>Button</dt>
<dd>The button's function is appending a row to the ListStore, so the <em>clicked</em> signal is required.</dd>
</dl>
</div>
</div>
<div class="section" id="python">
<h2><a class="toc-backref" href="posts/uberlistet/#id9">Python</a></h2>
<div class="section" id="treestore">
<h3><a class="toc-backref" href="posts/uberlistet/#id10">TreeStore</a></h3>
<p>The ListStore's row can be iterated over via <tt class="docutils literal">for row in store</tt>. New rows are added by <tt class="docutils literal">append</tt>, other options are <tt class="docutils literal">insert</tt> or <tt class="docutils literal">remove</tt> to add or delete rows at specific positions.</p>
</div>
<div class="section" id="combobox">
<h3><a class="toc-backref" href="posts/uberlistet/#id11">ComboBox</a></h3>
<p>For accessing a data row you need a <em>Gtk.TreeIter</em> object which points to the position in the model (this can also be achieved by a <em>Gtk.TreePath</em> object).</p>
<pre class="code python"><a name="rest_code_a459664856634718b5e1a5144febd1ad-1"></a><span class="nb">iter</span><span class="p">,</span><span class="n">model</span> <span class="o">=</span> <span class="n">widget</span><span class="o">.</span><span class="n">get_active_iter</span><span class="p">(),</span><span class="n">widget</span><span class="o">.</span><span class="n">get_model</span><span class="p">()</span>
<a name="rest_code_a459664856634718b5e1a5144febd1ad-2"></a><span class="n">row</span> <span class="o">=</span> <span class="n">model</span><span class="p">[</span><span class="nb">iter</span><span class="p">]</span>
<a name="rest_code_a459664856634718b5e1a5144febd1ad-3"></a><span class="k">print</span><span class="p">(</span><span class="s2">"Selection:"</span><span class="p">,</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre>
</div>
<div class="section" id="edit-cells">
<h3><a class="toc-backref" href="posts/uberlistet/#id12">Edit cells</a></h3>
<p>The <em>edited</em> signal passes the position and content of the edited cell. The new content of the <em>CellRendererText</em> has to explicitly be committed to the data store otherwise the content will return to the pre edit state. This can be accomplished by using the passed <em>TreePath</em> position.</p>
<pre class="code python"><a name="rest_code_2b02e7a66c9c40288fa4d1df5710bc50-1"></a><span class="k">def</span> <span class="nf">on_cellrenderer_descr_edited</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">widget</span><span class="p">,</span><span class="n">pos</span><span class="p">,</span><span class="n">edit</span><span class="p">):</span>
<a name="rest_code_2b02e7a66c9c40288fa4d1df5710bc50-2"></a>    <span class="n">x</span><span class="o">.</span><span class="n">store</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">pos</span><span class="p">)][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">edit</span>
</pre>
<p class="more"><a href="posts/uberlistet/">Read more…</a></p>
</div>
</div>
</div>
            </div>
        </div>
    
        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="." rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-1.html" rel="next">Older posts</a>
            </li>
        </ul></nav><script>var disqus_shortname="bahnfreikartoffelbrei";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script><footer id="footer"><p>Contents © 2017 <a href="mailto:An.Ke@bahnfreikartoffelbrei.de">Anke (encarsia)</a> - 
Powered by <a href="http://getnikola.com">Nikola</a> - 
Zen theme based in <a href="https://github.com/arusahni/website-template">Arusahni's website-template</a><br></p>
            
        </footer>
</div>
    </section><script src="../assets/js/all-nocdn.js" type="text/javascript"></script><script type="text/javascript">
            $(function(){
                $('.timeago').timeago();
            });
        </script>
</body>
</html>
