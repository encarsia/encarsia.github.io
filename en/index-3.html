<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="Gute Absichten">
<meta name="viewport" content="width=device-width">
<title>Merge and Destroy (old posts, page 3) | Merge and Destroy</title>
<link href="../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link rel="alternate" type="application/rss+xml" title="RSS (de)" href="../rss.xml">
<link rel="alternate" type="application/rss+xml" title="RSS (en)" href="rss.xml">
<link rel="canonical" href="https://encarsia.github.io/en/index-3.html">
<!--[if lt IE 9]><script src="/assets/js/html5.js"></script><![endif]-->
</head>
<body>
    <section class="social"><ul>
<li><a href="../index.html" title="Home"><i class="fa-home"></i></a></li>
            <li><a href="../posts/tutorial-reihe-glade/index.html" title="Tutorials"><i class="fa-lightbulb-o"></i></a></li>
            <li><a href="https://plus.google.com/105146352752269764996/posts" title="Google+"><i class="fa-google-plus-official"></i></a></li>
            <li><a href="https://github.com/encarsia" title="Github"><i class="fa-github"></i></a></li>
            <li><a href="https://twitter.com/encarsia_" title="Twitter"><i class="fa-twitter"></i></a></li>
            <li><a href="../categories/index.html" title="Tags"><i class="fa-tags"></i></a></li>
            <li><a href="../rss.xml" title="RSS"><i class="fa-rss"></i></a></li>
            <li><a href="../pages/about/index.html" title="About me"><i class="fa-user"></i></a></li>
            <li><a href="../archive.html" title="Archives"><i class="fa-folder-open"></i></a></li>

        </ul></section><section class="page-content"><div class="content" rel="main">
            
        <div class="post">
            <h1 class="title"><a href="posts/application/">Stand-alone</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2017-01-14T13:51:29+01:00">2017-01-14 13:51</time>
</div>
                <div class="stats">
                    
        
    <a href="posts/application/#disqus_thread" data-disqus-identifier="cache/posts/application.html">Comments</a>


                </div>
            
        <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/glade/" rel="tag">glade</a></li>
           <li><a class="tag p-category" href="categories/python/" rel="tag">python</a></li>
        </ul>
</div>

            </div>
            <div class="body">
                <div>
<div class="contents warning pull-right topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li>
<a class="reference internal" href="posts/application/#xml-files" id="id6">XML files</a><ul>
<li><a class="reference internal" href="posts/application/#glade" id="id7">Glade</a></li>
<li><a class="reference internal" href="posts/application/#gmenu" id="id8">GMenu</a></li>
</ul>
</li>
<li>
<a class="reference internal" href="posts/application/#python" id="id9">Python</a><ul>
<li><a class="reference internal" href="posts/application/#initialize-gtkapplication" id="id10">Initialize <em>GtkApplication</em></a></li>
<li><a class="reference internal" href="posts/application/#appmenu" id="id11">Appmenu</a></li>
<li><a class="reference internal" href="posts/application/#start-and-quit" id="id12">Start and quit</a></li>
</ul>
</li>
<li><a class="reference internal" href="posts/application/#links" id="id13">Links</a></li>
<li>
<a class="reference internal" href="posts/application/#listings" id="id14">Listings</a><ul>
<li><a class="reference internal" href="posts/application/#id3" id="id15">Glade</a></li>
<li><a class="reference internal" href="posts/application/#id4" id="id16">GMenu</a></li>
<li><a class="reference internal" href="posts/application/#id5" id="id17">Python</a></li>
</ul>
</li>
</ul>
</div>
<p><strong>Run program as GtkApplication</strong></p>
<p><em>GtkApplication</em> handles different important aspects of a GTK+ application like GTK+ initialization, session management and desktop integration.</p>
<a class="reference external image-reference" href="../images/14_application.png"><img alt="/images/14_application.thumbnail.png" src="../images/14_application.thumbnail.png"></a>
<div class="section" id="xml-files">
<h2><a class="toc-backref" href="posts/application/#id6">XML files</a></h2>
<div class="section" id="glade">
<h3><a class="toc-backref" href="posts/application/#id7">Glade</a></h3>
<p>Glade is used as usual, main windows should be <a href="posts/application/#id1"><span class="problematic" id="id2">**</span></a>GtkApplicationWindows*. As example the file from the <a class="reference external" href="posts/dialoge">dialogue article</a> is reused.</p>
<div class="system-message" id="id1">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">&lt;string&gt;</tt>, line 17); <em><a href="posts/application/#id2">backlink</a></em></p>
Inline strong start-string without end-string.</div>
</div>
<div class="section" id="gmenu">
<h3><a class="toc-backref" href="posts/application/#id8">GMenu</a></h3>
<p>The GNOME Shell supports appmenus residing in the (top) panel. The Gmenu XML file must be formatted to be recognized as <em>GioMenu</em>:</p>
<pre class="code xml"><a name="rest_code_dc86834175a34ed0897bbd0e9ed0f761-1"></a><span class="cp">&lt;?xml version="1.0"?&gt;</span>
<a name="rest_code_dc86834175a34ed0897bbd0e9ed0f761-2"></a><span class="nt">&lt;interface&gt;</span>
<a name="rest_code_dc86834175a34ed0897bbd0e9ed0f761-3"></a> <span class="nt">&lt;menu</span> <span class="na">id=</span><span class="s">"appmenu"</span><span class="nt">&gt;</span>
<a name="rest_code_dc86834175a34ed0897bbd0e9ed0f761-4"></a>    <span class="nt">&lt;section&gt;</span>
<a name="rest_code_dc86834175a34ed0897bbd0e9ed0f761-5"></a>      <span class="nt">&lt;item&gt;</span>
<a name="rest_code_dc86834175a34ed0897bbd0e9ed0f761-6"></a>        <span class="nt">&lt;attribute</span> <span class="na">name=</span><span class="s">"label"</span> <span class="na">translatable=</span><span class="s">"yes"</span><span class="nt">&gt;</span>Menu Item<span class="nt">&lt;/attribute&gt;</span>
<a name="rest_code_dc86834175a34ed0897bbd0e9ed0f761-7"></a>        <span class="nt">&lt;attribute</span> <span class="na">name=</span><span class="s">"action"</span><span class="nt">&gt;</span>app.item<span class="nt">&lt;/attribute&gt;</span>
<a name="rest_code_dc86834175a34ed0897bbd0e9ed0f761-8"></a>      <span class="nt">&lt;/item&gt;</span>
<a name="rest_code_dc86834175a34ed0897bbd0e9ed0f761-9"></a>    <span class="nt">&lt;/section&gt;</span>
<a name="rest_code_dc86834175a34ed0897bbd0e9ed0f761-10"></a>  <span class="nt">&lt;/menu&gt;</span>
<a name="rest_code_dc86834175a34ed0897bbd0e9ed0f761-11"></a><span class="nt">&lt;/interface&gt;</span>
</pre>
<p>Glade identifies this file format as an outdated Glade file and refuses to open it. Apart from that <em>GtkBuilder</em> can handle the menu and address identifiers.</p>
</div>
</div>
<div class="section" id="python">
<h2><a class="toc-backref" href="posts/application/#id9">Python</a></h2>
<div class="section" id="initialize-gtkapplication">
<h3><a class="toc-backref" href="posts/application/#id10">Initialize <em>GtkApplication</em></a></h3>
<p>The initialization process requires the parameters <em>application_id</em> and <em>flags</em>. Flags can normally set to 0 being the same as FLAGS_NONE (see <a class="reference external" href="https://lazka.github.io/pgi-docs/Gio-2.0/flags.html#Gio.ApplicationFlags">Gio.ApplicationFlags</a>), naming conventions for application_id are <a class="reference external" href="https://people.gnome.org/~gcampagna/docs/Gio-2.0/Gio.Application.id_is_valid.html">listed here</a>.</p>
<p>The application can be connected to different signals being emitted on preassigned events. It is mandatory to at least define an <tt class="docutils literal">activate</tt> signal:</p>
<pre class="code python"><a name="rest_code_001c918ddd8a4eab8b01139d4908c80d-1"></a><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a name="rest_code_001c918ddd8a4eab8b01139d4908c80d-2"></a>
<a name="rest_code_001c918ddd8a4eab8b01139d4908c80d-3"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">app</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">Application</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s2">"org.application.test"</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a name="rest_code_001c918ddd8a4eab8b01139d4908c80d-4"></a>    <span class="c1">#self.app.connect("startup", self.on_app_startup) #optional</span>
<a name="rest_code_001c918ddd8a4eab8b01139d4908c80d-5"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">"activate"</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_app_activate</span><span class="p">)</span>
<a name="rest_code_001c918ddd8a4eab8b01139d4908c80d-6"></a>    <span class="c1">#self.app.connect("shutdown", self.on_app_shutdown) #optional</span>
<a name="rest_code_001c918ddd8a4eab8b01139d4908c80d-7"></a>
<a name="rest_code_001c918ddd8a4eab8b01139d4908c80d-8"></a><span class="k">def</span> <span class="nf">on_app_activate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">app</span><span class="p">):</span>
<a name="rest_code_001c918ddd8a4eab8b01139d4908c80d-9"></a>
<a name="rest_code_001c918ddd8a4eab8b01139d4908c80d-10"></a>    <span class="c1">#setting up GtkBuilder etc.</span>
<a name="rest_code_001c918ddd8a4eab8b01139d4908c80d-11"></a>    <span class="o">...</span>
<a name="rest_code_001c918ddd8a4eab8b01139d4908c80d-12"></a>    <span class="o">...</span>
<a name="rest_code_001c918ddd8a4eab8b01139d4908c80d-13"></a>    <span class="o">...</span>
</pre>
</div>
<div class="section" id="appmenu">
<h3><a class="toc-backref" href="posts/application/#id11">Appmenu</a></h3>
<p>GMenu XML files are loaded by <em>GtkBuilder</em>:</p>
<pre class="code python"><a name="rest_code_54c3ab1fac414a6da2163f5633313308-1"></a><span class="n">builder</span><span class="o">.</span><span class="n">add_from_file</span><span class="p">(</span><span class="s2">"menu.ui"</span><span class="p">)</span>
<a name="rest_code_54c3ab1fac414a6da2163f5633313308-2"></a><span class="n">app</span><span class="o">.</span><span class="n">set_app_menu</span><span class="p">(</span><span class="n">builder</span><span class="o">.</span><span class="n">get_object</span><span class="p">(</span><span class="s2">"appmenu"</span><span class="p">))</span>
</pre>
<p>Menu entries now have to be connected to actions which are created as <em>GioSimpleActions</em>:</p>
<pre class="code python"><a name="rest_code_7e81e0be137545da96fb84a2c586c3f2-1"></a><span class="k">def</span> <span class="nf">add_simple_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">callback</span><span class="p">):</span>
<a name="rest_code_7e81e0be137545da96fb84a2c586c3f2-2"></a>    <span class="n">action</span> <span class="o">=</span> <span class="n">Gio</span><span class="o">.</span><span class="n">SimpleAction</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
<a name="rest_code_7e81e0be137545da96fb84a2c586c3f2-3"></a>    <span class="n">action</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">"activate"</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
<a name="rest_code_7e81e0be137545da96fb84a2c586c3f2-4"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">add_action</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
</pre>
<p>In the example file actions invokes dialog windows.</p>
</div>
<div class="section" id="start-and-quit">
<h3><a class="toc-backref" href="posts/application/#id12">Start and quit</a></h3>
<p><em>GtkApplication</em> takes over the handling of the GTK+ mainloop so there is no need of starting and quitting GTK+ manually and <tt class="docutils literal">run()</tt> and <tt class="docutils literal">quit()</tt> called instead:</p>
<pre class="code text"><a name="rest_code_30960bd7dde94c6d8af7924be336236e-1"></a>Gtk.main()      -&gt;  app.run(argv)
<a name="rest_code_30960bd7dde94c6d8af7924be336236e-2"></a>Gtk.main_quit() -&gt;  app.quit()
</pre>
<p>If the application is quit by the [X] button or the "Quit" appmenu entry the "shutdown" signal is emitted (see above) and the program is terminated. That means there is no need to define these signals like in previous examples using <em>GtkWindow</em>. The "shutdown" also works even if the signal is not explicitly connected to a function during the initialization process.</p>
</div>
</div>
<div class="section" id="links">
<h2><a class="toc-backref" href="posts/application/#id13">Links</a></h2>
<blockquote>
<ul class="simple">
<li><a class="reference external" href="https://developer.gnome.org/gtk3/stable/GtkApplication.html">GNOME Developer: GtkApplication</a></li>
<li><a class="reference external" href="http://www.bachsau.com/2015/07/13/how-to-use-gtk-3-in-python-to-manage-your-whole-application/">How to use GTK+ 3 in Python to manage your whole application</a></li>
<li><a class="reference external" href="http://stackoverflow.com/questions/19481439/how-to-create-a-complete-menu-using-gio-actions-in-pygi-gtk">Stackoverflow: How to create a complete menu using GIO Actions in PyGI GTK?</a></li>
</ul>
</blockquote>
<p class="more"><a href="posts/application/">Read more…</a></p>
</div>
</div>
            </div>
        </div>
    
        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="." rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-2.html" rel="next">Older posts</a>
            </li>
        </ul></nav><script>var disqus_shortname="bahnfreikartoffelbrei";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script><footer id="footer"><p>Contents © 2017 <a href="mailto:An.Ke@bahnfreikartoffelbrei.de">Anke (encarsia)</a> - 
Powered by <a href="http://getnikola.com">Nikola</a> - 
Zen theme based in <a href="https://github.com/arusahni/website-template">Arusahni's website-template</a><br></p>
            
        </footer>
</div>
    </section><script src="../assets/js/all-nocdn.js" type="text/javascript"></script><script type="text/javascript">
            $(function(){
                $('.timeago').timeago();
            });
        </script>
</body>
</html>
