<!DOCTYPE html>
<html prefix="
" lang="de">
<head>
<meta charset="utf-8">
<meta name="description" content="import_gplus.py">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Merge and Destroy · import_gplus.py </title>
<link href="../assets/css/all.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700%7CAbril+Fatface">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fork-awesome@1.1.7/css/fork-awesome.min.css" integrity="sha256-gsmEoJAws/Kd3CjuOQzLie5Q3yshhvmo7YNtBG7aaEY=" crossorigin="anonymous">
<meta content="#5670d4" name="theme-color">
<link rel="alternate" type="application/rss+xml" title="RSS (de)" href="../rss.xml">
<link rel="alternate" type="application/rss+xml" title="RSS (en)" href="../en/rss.xml">
<link rel="canonical" href="https://encarsia.github.io/listings/import_gplus.py.html">
<link rel="icon" href="../files/favicon.ico" sizes="48x48">
<!--[if lt IE 9]><script src="../assets/js/html5.js"></script><![endif]-->
</head>
<body class="theme-custom">
    <a href="#content" class="sr-only sr-only-focusable">Springe zum Hauptinhalt</a>
    <div class="hsidebar">
        <div class="container sidebar-sticky">
            
                <nav id="menu" role="navigation" class="sidebar-nav"><a class="sidebar-nav-item" href="../index.html" title="Home"><i class="fa fa-home"></i>Home</a>
            <a class="sidebar-nav-item" href="../posts/tutorial-reihe-glade" title="Tutorials"><i class="fa fa-lightbulb-o"></i>Tutorials</a>
            <a class="sidebar-nav-item" href="../projects/index.html" title="Projects"><i class="fa fa-wrench"></i>Projects</a>
            <a class="sidebar-nav-item" href="https://octodon.social/@encarsia" title="Mastodon"><i class="fa fa-mastodon"></i>Mastodon</a>
            <a class="sidebar-nav-item" href="https://pixelfed.social/encarsia" title="Pixelfed"><i class="fa fa-pixelfed"></i>Pixelfed</a>
            <a class="sidebar-nav-item" href="https://twitter.com/encarsia_" title="Twitter"><i class="fa fa-twitter"></i>Twitter</a>
            <a class="sidebar-nav-item" href="https://github.com/encarsia" title="GitHub"><i class="fa fa-github"></i>GitHub</a>
            <a class="sidebar-nav-item" href="../pages/gplus_the_end" title="Google+"><i class="fa fa-google-plus-official"></i>Google+</a>
            <a class="sidebar-nav-item" href="../categories/index.html" title="Tags"><i class="fa fa-tags"></i>Tags</a>
            <a class="sidebar-nav-item" href="../archive.html" title="Archive"><i class="fa fa-folder-open"></i>Archive</a>
            <a class="sidebar-nav-item" href="../rss.xml" title="RSS"><i class="fa fa-feed"></i>RSS</a>
    
    
    </nav><footer id="footer"><span class="copyright">
              
<hr>
Contents © 2019 <a href="mailto:An.Ke@bahnfreikartoffelbrei.de">Anke (encarsia)</a>
<br> 
Powered by <a href="http://getnikola.com">Nikola</a> - 
Hybrid theme

            </span>
            
            
        </footer>
</div>
    </div>
    <div class="content container" id="content">
<nav class="breadcrumbs"><ul class="breadcrumb">
<li><a href=".">listings</a></li>
                <li>import_gplus.py</li>
</ul></nav><h1>import_gplus.py
            <small><a href="import_gplus.py">(Source)</a></small>
        </h1>
    <table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="#listingsimport_gpluspy-1">  1</a>
<a href="#listingsimport_gpluspy-2">  2</a>
<a href="#listingsimport_gpluspy-3">  3</a>
<a href="#listingsimport_gpluspy-4">  4</a>
<a href="#listingsimport_gpluspy-5">  5</a>
<a href="#listingsimport_gpluspy-6">  6</a>
<a href="#listingsimport_gpluspy-7">  7</a>
<a href="#listingsimport_gpluspy-8">  8</a>
<a href="#listingsimport_gpluspy-9">  9</a>
<a href="#listingsimport_gpluspy-10"> 10</a>
<a href="#listingsimport_gpluspy-11"> 11</a>
<a href="#listingsimport_gpluspy-12"> 12</a>
<a href="#listingsimport_gpluspy-13"> 13</a>
<a href="#listingsimport_gpluspy-14"> 14</a>
<a href="#listingsimport_gpluspy-15"> 15</a>
<a href="#listingsimport_gpluspy-16"> 16</a>
<a href="#listingsimport_gpluspy-17"> 17</a>
<a href="#listingsimport_gpluspy-18"> 18</a>
<a href="#listingsimport_gpluspy-19"> 19</a>
<a href="#listingsimport_gpluspy-20"> 20</a>
<a href="#listingsimport_gpluspy-21"> 21</a>
<a href="#listingsimport_gpluspy-22"> 22</a>
<a href="#listingsimport_gpluspy-23"> 23</a>
<a href="#listingsimport_gpluspy-24"> 24</a>
<a href="#listingsimport_gpluspy-25"> 25</a>
<a href="#listingsimport_gpluspy-26"> 26</a>
<a href="#listingsimport_gpluspy-27"> 27</a>
<a href="#listingsimport_gpluspy-28"> 28</a>
<a href="#listingsimport_gpluspy-29"> 29</a>
<a href="#listingsimport_gpluspy-30"> 30</a>
<a href="#listingsimport_gpluspy-31"> 31</a>
<a href="#listingsimport_gpluspy-32"> 32</a>
<a href="#listingsimport_gpluspy-33"> 33</a>
<a href="#listingsimport_gpluspy-34"> 34</a>
<a href="#listingsimport_gpluspy-35"> 35</a>
<a href="#listingsimport_gpluspy-36"> 36</a>
<a href="#listingsimport_gpluspy-37"> 37</a>
<a href="#listingsimport_gpluspy-38"> 38</a>
<a href="#listingsimport_gpluspy-39"> 39</a>
<a href="#listingsimport_gpluspy-40"> 40</a>
<a href="#listingsimport_gpluspy-41"> 41</a>
<a href="#listingsimport_gpluspy-42"> 42</a>
<a href="#listingsimport_gpluspy-43"> 43</a>
<a href="#listingsimport_gpluspy-44"> 44</a>
<a href="#listingsimport_gpluspy-45"> 45</a>
<a href="#listingsimport_gpluspy-46"> 46</a>
<a href="#listingsimport_gpluspy-47"> 47</a>
<a href="#listingsimport_gpluspy-48"> 48</a>
<a href="#listingsimport_gpluspy-49"> 49</a>
<a href="#listingsimport_gpluspy-50"> 50</a>
<a href="#listingsimport_gpluspy-51"> 51</a>
<a href="#listingsimport_gpluspy-52"> 52</a>
<a href="#listingsimport_gpluspy-53"> 53</a>
<a href="#listingsimport_gpluspy-54"> 54</a>
<a href="#listingsimport_gpluspy-55"> 55</a>
<a href="#listingsimport_gpluspy-56"> 56</a>
<a href="#listingsimport_gpluspy-57"> 57</a>
<a href="#listingsimport_gpluspy-58"> 58</a>
<a href="#listingsimport_gpluspy-59"> 59</a>
<a href="#listingsimport_gpluspy-60"> 60</a>
<a href="#listingsimport_gpluspy-61"> 61</a>
<a href="#listingsimport_gpluspy-62"> 62</a>
<a href="#listingsimport_gpluspy-63"> 63</a>
<a href="#listingsimport_gpluspy-64"> 64</a>
<a href="#listingsimport_gpluspy-65"> 65</a>
<a href="#listingsimport_gpluspy-66"> 66</a>
<a href="#listingsimport_gpluspy-67"> 67</a>
<a href="#listingsimport_gpluspy-68"> 68</a>
<a href="#listingsimport_gpluspy-69"> 69</a>
<a href="#listingsimport_gpluspy-70"> 70</a>
<a href="#listingsimport_gpluspy-71"> 71</a>
<a href="#listingsimport_gpluspy-72"> 72</a>
<a href="#listingsimport_gpluspy-73"> 73</a>
<a href="#listingsimport_gpluspy-74"> 74</a>
<a href="#listingsimport_gpluspy-75"> 75</a>
<a href="#listingsimport_gpluspy-76"> 76</a>
<a href="#listingsimport_gpluspy-77"> 77</a>
<a href="#listingsimport_gpluspy-78"> 78</a>
<a href="#listingsimport_gpluspy-79"> 79</a>
<a href="#listingsimport_gpluspy-80"> 80</a>
<a href="#listingsimport_gpluspy-81"> 81</a>
<a href="#listingsimport_gpluspy-82"> 82</a>
<a href="#listingsimport_gpluspy-83"> 83</a>
<a href="#listingsimport_gpluspy-84"> 84</a>
<a href="#listingsimport_gpluspy-85"> 85</a>
<a href="#listingsimport_gpluspy-86"> 86</a>
<a href="#listingsimport_gpluspy-87"> 87</a>
<a href="#listingsimport_gpluspy-88"> 88</a>
<a href="#listingsimport_gpluspy-89"> 89</a>
<a href="#listingsimport_gpluspy-90"> 90</a>
<a href="#listingsimport_gpluspy-91"> 91</a>
<a href="#listingsimport_gpluspy-92"> 92</a>
<a href="#listingsimport_gpluspy-93"> 93</a>
<a href="#listingsimport_gpluspy-94"> 94</a>
<a href="#listingsimport_gpluspy-95"> 95</a>
<a href="#listingsimport_gpluspy-96"> 96</a>
<a href="#listingsimport_gpluspy-97"> 97</a>
<a href="#listingsimport_gpluspy-98"> 98</a>
<a href="#listingsimport_gpluspy-99"> 99</a>
<a href="#listingsimport_gpluspy-100">100</a>
<a href="#listingsimport_gpluspy-101">101</a>
<a href="#listingsimport_gpluspy-102">102</a>
<a href="#listingsimport_gpluspy-103">103</a>
<a href="#listingsimport_gpluspy-104">104</a>
<a href="#listingsimport_gpluspy-105">105</a>
<a href="#listingsimport_gpluspy-106">106</a>
<a href="#listingsimport_gpluspy-107">107</a>
<a href="#listingsimport_gpluspy-108">108</a>
<a href="#listingsimport_gpluspy-109">109</a>
<a href="#listingsimport_gpluspy-110">110</a>
<a href="#listingsimport_gpluspy-111">111</a>
<a href="#listingsimport_gpluspy-112">112</a>
<a href="#listingsimport_gpluspy-113">113</a>
<a href="#listingsimport_gpluspy-114">114</a>
<a href="#listingsimport_gpluspy-115">115</a>
<a href="#listingsimport_gpluspy-116">116</a>
<a href="#listingsimport_gpluspy-117">117</a>
<a href="#listingsimport_gpluspy-118">118</a>
<a href="#listingsimport_gpluspy-119">119</a>
<a href="#listingsimport_gpluspy-120">120</a>
<a href="#listingsimport_gpluspy-121">121</a>
<a href="#listingsimport_gpluspy-122">122</a>
<a href="#listingsimport_gpluspy-123">123</a>
<a href="#listingsimport_gpluspy-124">124</a>
<a href="#listingsimport_gpluspy-125">125</a>
<a href="#listingsimport_gpluspy-126">126</a>
<a href="#listingsimport_gpluspy-127">127</a>
<a href="#listingsimport_gpluspy-128">128</a>
<a href="#listingsimport_gpluspy-129">129</a>
<a href="#listingsimport_gpluspy-130">130</a>
<a href="#listingsimport_gpluspy-131">131</a>
<a href="#listingsimport_gpluspy-132">132</a>
<a href="#listingsimport_gpluspy-133">133</a>
<a href="#listingsimport_gpluspy-134">134</a>
<a href="#listingsimport_gpluspy-135">135</a>
<a href="#listingsimport_gpluspy-136">136</a>
<a href="#listingsimport_gpluspy-137">137</a>
<a href="#listingsimport_gpluspy-138">138</a>
<a href="#listingsimport_gpluspy-139">139</a>
<a href="#listingsimport_gpluspy-140">140</a>
<a href="#listingsimport_gpluspy-141">141</a>
<a href="#listingsimport_gpluspy-142">142</a>
<a href="#listingsimport_gpluspy-143">143</a>
<a href="#listingsimport_gpluspy-144">144</a>
<a href="#listingsimport_gpluspy-145">145</a>
<a href="#listingsimport_gpluspy-146">146</a>
<a href="#listingsimport_gpluspy-147">147</a>
<a href="#listingsimport_gpluspy-148">148</a>
<a href="#listingsimport_gpluspy-149">149</a>
<a href="#listingsimport_gpluspy-150">150</a>
<a href="#listingsimport_gpluspy-151">151</a>
<a href="#listingsimport_gpluspy-152">152</a>
<a href="#listingsimport_gpluspy-153">153</a>
<a href="#listingsimport_gpluspy-154">154</a>
<a href="#listingsimport_gpluspy-155">155</a>
<a href="#listingsimport_gpluspy-156">156</a>
<a href="#listingsimport_gpluspy-157">157</a>
<a href="#listingsimport_gpluspy-158">158</a>
<a href="#listingsimport_gpluspy-159">159</a>
<a href="#listingsimport_gpluspy-160">160</a>
<a href="#listingsimport_gpluspy-161">161</a>
<a href="#listingsimport_gpluspy-162">162</a>
<a href="#listingsimport_gpluspy-163">163</a>
<a href="#listingsimport_gpluspy-164">164</a>
<a href="#listingsimport_gpluspy-165">165</a>
<a href="#listingsimport_gpluspy-166">166</a>
<a href="#listingsimport_gpluspy-167">167</a>
<a href="#listingsimport_gpluspy-168">168</a>
<a href="#listingsimport_gpluspy-169">169</a>
<a href="#listingsimport_gpluspy-170">170</a>
<a href="#listingsimport_gpluspy-171">171</a>
<a href="#listingsimport_gpluspy-172">172</a>
<a href="#listingsimport_gpluspy-173">173</a>
<a href="#listingsimport_gpluspy-174">174</a>
<a href="#listingsimport_gpluspy-175">175</a>
<a href="#listingsimport_gpluspy-176">176</a>
<a href="#listingsimport_gpluspy-177">177</a>
<a href="#listingsimport_gpluspy-178">178</a>
<a href="#listingsimport_gpluspy-179">179</a>
<a href="#listingsimport_gpluspy-180">180</a>
<a href="#listingsimport_gpluspy-181">181</a>
<a href="#listingsimport_gpluspy-182">182</a>
<a href="#listingsimport_gpluspy-183">183</a>
<a href="#listingsimport_gpluspy-184">184</a>
<a href="#listingsimport_gpluspy-185">185</a>
<a href="#listingsimport_gpluspy-186">186</a>
<a href="#listingsimport_gpluspy-187">187</a>
<a href="#listingsimport_gpluspy-188">188</a>
<a href="#listingsimport_gpluspy-189">189</a>
<a href="#listingsimport_gpluspy-190">190</a>
<a href="#listingsimport_gpluspy-191">191</a>
<a href="#listingsimport_gpluspy-192">192</a>
<a href="#listingsimport_gpluspy-193">193</a>
<a href="#listingsimport_gpluspy-194">194</a>
<a href="#listingsimport_gpluspy-195">195</a>
<a href="#listingsimport_gpluspy-196">196</a>
<a href="#listingsimport_gpluspy-197">197</a>
<a href="#listingsimport_gpluspy-198">198</a>
<a href="#listingsimport_gpluspy-199">199</a>
<a href="#listingsimport_gpluspy-200">200</a>
<a href="#listingsimport_gpluspy-201">201</a>
<a href="#listingsimport_gpluspy-202">202</a>
<a href="#listingsimport_gpluspy-203">203</a>
<a href="#listingsimport_gpluspy-204">204</a>
<a href="#listingsimport_gpluspy-205">205</a>
<a href="#listingsimport_gpluspy-206">206</a>
<a href="#listingsimport_gpluspy-207">207</a>
<a href="#listingsimport_gpluspy-208">208</a>
<a href="#listingsimport_gpluspy-209">209</a>
<a href="#listingsimport_gpluspy-210">210</a>
<a href="#listingsimport_gpluspy-211">211</a>
<a href="#listingsimport_gpluspy-212">212</a>
<a href="#listingsimport_gpluspy-213">213</a>
<a href="#listingsimport_gpluspy-214">214</a>
<a href="#listingsimport_gpluspy-215">215</a>
<a href="#listingsimport_gpluspy-216">216</a>
<a href="#listingsimport_gpluspy-217">217</a>
<a href="#listingsimport_gpluspy-218">218</a>
<a href="#listingsimport_gpluspy-219">219</a>
<a href="#listingsimport_gpluspy-220">220</a>
<a href="#listingsimport_gpluspy-221">221</a>
<a href="#listingsimport_gpluspy-222">222</a>
<a href="#listingsimport_gpluspy-223">223</a>
<a href="#listingsimport_gpluspy-224">224</a>
<a href="#listingsimport_gpluspy-225">225</a>
<a href="#listingsimport_gpluspy-226">226</a>
<a href="#listingsimport_gpluspy-227">227</a>
<a href="#listingsimport_gpluspy-228">228</a>
<a href="#listingsimport_gpluspy-229">229</a>
<a href="#listingsimport_gpluspy-230">230</a>
<a href="#listingsimport_gpluspy-231">231</a>
<a href="#listingsimport_gpluspy-232">232</a>
<a href="#listingsimport_gpluspy-233">233</a>
<a href="#listingsimport_gpluspy-234">234</a>
<a href="#listingsimport_gpluspy-235">235</a>
<a href="#listingsimport_gpluspy-236">236</a>
<a href="#listingsimport_gpluspy-237">237</a>
<a href="#listingsimport_gpluspy-238">238</a>
<a href="#listingsimport_gpluspy-239">239</a>
<a href="#listingsimport_gpluspy-240">240</a>
<a href="#listingsimport_gpluspy-241">241</a>
<a href="#listingsimport_gpluspy-242">242</a>
<a href="#listingsimport_gpluspy-243">243</a>
<a href="#listingsimport_gpluspy-244">244</a>
<a href="#listingsimport_gpluspy-245">245</a>
<a href="#listingsimport_gpluspy-246">246</a>
<a href="#listingsimport_gpluspy-247">247</a>
<a href="#listingsimport_gpluspy-248">248</a>
<a href="#listingsimport_gpluspy-249">249</a>
<a href="#listingsimport_gpluspy-250">250</a>
<a href="#listingsimport_gpluspy-251">251</a>
<a href="#listingsimport_gpluspy-252">252</a>
<a href="#listingsimport_gpluspy-253">253</a>
<a href="#listingsimport_gpluspy-254">254</a>
<a href="#listingsimport_gpluspy-255">255</a>
<a href="#listingsimport_gpluspy-256">256</a>
<a href="#listingsimport_gpluspy-257">257</a>
<a href="#listingsimport_gpluspy-258">258</a>
<a href="#listingsimport_gpluspy-259">259</a>
<a href="#listingsimport_gpluspy-260">260</a>
<a href="#listingsimport_gpluspy-261">261</a>
<a href="#listingsimport_gpluspy-262">262</a>
<a href="#listingsimport_gpluspy-263">263</a>
<a href="#listingsimport_gpluspy-264">264</a>
<a href="#listingsimport_gpluspy-265">265</a>
<a href="#listingsimport_gpluspy-266">266</a>
<a href="#listingsimport_gpluspy-267">267</a>
<a href="#listingsimport_gpluspy-268">268</a>
<a href="#listingsimport_gpluspy-269">269</a>
<a href="#listingsimport_gpluspy-270">270</a>
<a href="#listingsimport_gpluspy-271">271</a></pre></div></td>
<td class="code"><pre class="code literal-block"><a name="listingsimport_gpluspy-1"></a><span class="c1"># -*- coding: utf-8 -*-</span>
<a name="listingsimport_gpluspy-2"></a>
<a name="listingsimport_gpluspy-3"></a><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">unicode_literals</span><span class="p">,</span> <span class="n">print_function</span>
<a name="listingsimport_gpluspy-4"></a><span class="kn">import</span> <span class="nn">os</span>
<a name="listingsimport_gpluspy-5"></a><span class="kn">import</span> <span class="nn">shutil</span>
<a name="listingsimport_gpluspy-6"></a>
<a name="listingsimport_gpluspy-7"></a><span class="k">try</span><span class="p">:</span>
<a name="listingsimport_gpluspy-8"></a>    <span class="kn">import</span> <span class="nn">bs4</span>
<a name="listingsimport_gpluspy-9"></a><span class="k">except</span> <span class="ne">ModuleNotFoundError</span><span class="p">:</span>
<a name="listingsimport_gpluspy-10"></a>    <span class="k">raise</span>
<a name="listingsimport_gpluspy-11"></a>
<a name="listingsimport_gpluspy-12"></a><span class="kn">from</span> <span class="nn">nikola.plugin_categories</span> <span class="kn">import</span> <span class="n">Command</span>
<a name="listingsimport_gpluspy-13"></a><span class="kn">from</span> <span class="nn">nikola</span> <span class="kn">import</span> <span class="n">utils</span>
<a name="listingsimport_gpluspy-14"></a><span class="kn">from</span> <span class="nn">nikola.utils</span> <span class="kn">import</span> <span class="n">req_missing</span>
<a name="listingsimport_gpluspy-15"></a><span class="kn">from</span> <span class="nn">nikola.plugins.basic_import</span> <span class="kn">import</span> <span class="n">ImportMixin</span>
<a name="listingsimport_gpluspy-16"></a><span class="kn">from</span> <span class="nn">nikola.plugins.command.init</span> <span class="kn">import</span> <span class="n">SAMPLE_CONF</span><span class="p">,</span> <span class="n">prepare_config</span>
<a name="listingsimport_gpluspy-17"></a>
<a name="listingsimport_gpluspy-18"></a><span class="n">LOGGER</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_logger</span><span class="p">(</span><span class="s1">'import_gplus'</span><span class="p">,</span> <span class="n">utils</span><span class="o">.</span><span class="n">STDERR_HANDLER</span><span class="p">)</span>
<a name="listingsimport_gpluspy-19"></a>
<a name="listingsimport_gpluspy-20"></a>
<a name="listingsimport_gpluspy-21"></a><span class="k">class</span> <span class="nc">CommandImportGplus</span><span class="p">(</span><span class="n">Command</span><span class="p">,</span> <span class="n">ImportMixin</span><span class="p">):</span>
<a name="listingsimport_gpluspy-22"></a>    <span class="sd">"""Import a Google+ dump."""</span>
<a name="listingsimport_gpluspy-23"></a>
<a name="listingsimport_gpluspy-24"></a>    <span class="n">name</span> <span class="o">=</span> <span class="s2">"import_gplus"</span>
<a name="listingsimport_gpluspy-25"></a>    <span class="n">needs_config</span> <span class="o">=</span> <span class="bp">False</span>
<a name="listingsimport_gpluspy-26"></a>    <span class="n">doc_usage</span> <span class="o">=</span> <span class="s2">"[options] extracted_dump_file_folder"</span>
<a name="listingsimport_gpluspy-27"></a>    <span class="n">doc_purpose</span> <span class="o">=</span> <span class="s2">"import a Google+ dump"</span>
<a name="listingsimport_gpluspy-28"></a>    <span class="n">cmd_options</span> <span class="o">=</span> <span class="n">ImportMixin</span><span class="o">.</span><span class="n">cmd_options</span>
<a name="listingsimport_gpluspy-29"></a>
<a name="listingsimport_gpluspy-30"></a>    <span class="k">def</span> <span class="nf">_execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">options</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
<a name="listingsimport_gpluspy-31"></a>        <span class="sd">'''</span>
<a name="listingsimport_gpluspy-32"></a><span class="sd">            Import Google+ dump</span>
<a name="listingsimport_gpluspy-33"></a><span class="sd">        '''</span>
<a name="listingsimport_gpluspy-34"></a>
<a name="listingsimport_gpluspy-35"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">args</span><span class="p">:</span>
<a name="listingsimport_gpluspy-36"></a>            <span class="k">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">help</span><span class="p">())</span>
<a name="listingsimport_gpluspy-37"></a>            <span class="k">return</span>
<a name="listingsimport_gpluspy-38"></a>
<a name="listingsimport_gpluspy-39"></a>        <span class="n">options</span><span class="p">[</span><span class="s1">'filename'</span><span class="p">]</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a name="listingsimport_gpluspy-40"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">export_folder</span> <span class="o">=</span> <span class="n">options</span><span class="p">[</span><span class="s1">'filename'</span><span class="p">]</span>
<a name="listingsimport_gpluspy-41"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_folder</span> <span class="o">=</span> <span class="n">options</span><span class="p">[</span><span class="s1">'output_folder'</span><span class="p">]</span>
<a name="listingsimport_gpluspy-42"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">import_into_existing_site</span> <span class="o">=</span> <span class="bp">False</span>
<a name="listingsimport_gpluspy-43"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">url_map</span> <span class="o">=</span> <span class="p">{}</span>
<a name="listingsimport_gpluspy-44"></a>
<a name="listingsimport_gpluspy-45"></a>        <span class="c1"># Google Takeout folder structure, adapt to your language settings</span>
<a name="listingsimport_gpluspy-46"></a>        
<a name="listingsimport_gpluspy-47"></a>        <span class="c1"># Takeout/</span>
<a name="listingsimport_gpluspy-48"></a>        <span class="c1"># ├── +1/</span>
<a name="listingsimport_gpluspy-49"></a>        <span class="c1"># ├── Google+ stream/</span>
<a name="listingsimport_gpluspy-50"></a>        <span class="c1"># |   ├── Posts/</span>
<a name="listingsimport_gpluspy-51"></a>        <span class="c1"># |   ├── Photos/</span>
<a name="listingsimport_gpluspy-52"></a>        <span class="c1"># |   |   ├── Photos of posts/</span>
<a name="listingsimport_gpluspy-53"></a>        <span class="c1"># |   |   └── Photos of polls/</span>
<a name="listingsimport_gpluspy-54"></a>        <span class="c1"># |   ├── Activities/</span>
<a name="listingsimport_gpluspy-55"></a>        <span class="c1"># |   ├── Collections/</span>
<a name="listingsimport_gpluspy-56"></a>        <span class="c1"># |   └── Events/</span>
<a name="listingsimport_gpluspy-57"></a>        <span class="c1"># ├── Google+ Communities/</span>
<a name="listingsimport_gpluspy-58"></a>        <span class="c1"># └── index.html</span>
<a name="listingsimport_gpluspy-59"></a>        
<a name="listingsimport_gpluspy-60"></a>        <span class="n">gto_root</span> <span class="o">=</span> <span class="s2">"Takeout"</span>
<a name="listingsimport_gpluspy-61"></a>        <span class="n">gto_plus1</span> <span class="o">=</span> <span class="s2">"+1"</span>
<a name="listingsimport_gpluspy-62"></a>        <span class="n">gto_stream</span> <span class="o">=</span> <span class="s2">"Stream in Google+"</span>
<a name="listingsimport_gpluspy-63"></a>        <span class="n">gto_posts</span> <span class="o">=</span> <span class="s2">"Beiträge"</span>
<a name="listingsimport_gpluspy-64"></a>        <span class="n">gto_photos</span> <span class="o">=</span> <span class="s2">"Fotos"</span>
<a name="listingsimport_gpluspy-65"></a>        <span class="n">gto_photos_posts</span> <span class="o">=</span> <span class="s2">"Fotos von Beiträgen"</span>
<a name="listingsimport_gpluspy-66"></a>        <span class="n">gto_photos_polls</span> <span class="o">=</span> <span class="s2">"Umfragefotos"</span>
<a name="listingsimport_gpluspy-67"></a>        <span class="n">gto_activity</span> <span class="o">=</span> <span class="s2">"Aktivitätsprotokoll"</span>
<a name="listingsimport_gpluspy-68"></a>        <span class="n">gto_collections</span> <span class="o">=</span> <span class="s2">"Sammlungen"</span>
<a name="listingsimport_gpluspy-69"></a>        <span class="n">gto_events</span> <span class="o">=</span> <span class="s2">"Veranstaltungen"</span>
<a name="listingsimport_gpluspy-70"></a>        <span class="n">gto_communities</span> <span class="o">=</span> <span class="s2">"Google+ Communities"</span>
<a name="listingsimport_gpluspy-71"></a>
<a name="listingsimport_gpluspy-72"></a>        <span class="c1"># path to HTML formatted post files</span>
<a name="listingsimport_gpluspy-73"></a>        <span class="n">post_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">export_folder</span><span class="p">,</span>
<a name="listingsimport_gpluspy-74"></a>                                 <span class="n">gto_root</span><span class="p">,</span>
<a name="listingsimport_gpluspy-75"></a>                                 <span class="n">gto_stream</span><span class="p">,</span>
<a name="listingsimport_gpluspy-76"></a>                                 <span class="n">gto_posts</span><span class="p">)</span>
<a name="listingsimport_gpluspy-77"></a>        
<a name="listingsimport_gpluspy-78"></a>        <span class="c1"># collect all files</span>
<a name="listingsimport_gpluspy-79"></a>        <span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">post_path</span><span class="p">))</span> <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">post_path</span><span class="p">,</span> <span class="n">f</span><span class="p">))]</span>
<a name="listingsimport_gpluspy-80"></a>
<a name="listingsimport_gpluspy-81"></a>        <span class="c1"># filter relevant HTML files</span>
<a name="listingsimport_gpluspy-82"></a>        <span class="n">html_files</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files</span> <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">".html"</span><span class="p">)]</span>
<a name="listingsimport_gpluspy-83"></a>        <span class="n">LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">"{} posts ready for import"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">html_files</span><span class="p">)))</span>
<a name="listingsimport_gpluspy-84"></a>        
<a name="listingsimport_gpluspy-85"></a>        <span class="c1"># init new Nikola site "new_site", edit conf.py to your needs</span>
<a name="listingsimport_gpluspy-86"></a>        <span class="c1"># change to this folder for the for build process</span>
<a name="listingsimport_gpluspy-87"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">populate_context</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">export_folder</span><span class="p">,</span> <span class="n">html_files</span><span class="p">,</span> <span class="n">post_path</span><span class="p">)</span>
<a name="listingsimport_gpluspy-88"></a>        <span class="n">conf_template</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_base_site</span><span class="p">()</span>
<a name="listingsimport_gpluspy-89"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">write_configuration</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_configuration_output_path</span><span class="p">(),</span> <span class="n">conf_template</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="o">**</span><span class="n">prepare_config</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="p">)))</span>
<a name="listingsimport_gpluspy-90"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">import_posts</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">export_folder</span><span class="p">,</span> <span class="n">html_files</span><span class="p">,</span> <span class="n">post_path</span><span class="p">)</span>
<a name="listingsimport_gpluspy-91"></a>        
<a name="listingsimport_gpluspy-92"></a>        <span class="c1"># In the Takeout archive photos are linked to the main working</span>
<a name="listingsimport_gpluspy-93"></a>        <span class="c1"># directory although they do not necessarily exist there (Hello</span>
<a name="listingsimport_gpluspy-94"></a>        <span class="c1"># deadlinks!). The image files are spread to several folders.</span>
<a name="listingsimport_gpluspy-95"></a>
<a name="listingsimport_gpluspy-96"></a>        <span class="c1"># All archive photos will be copied to the "images" folder.</span>
<a name="listingsimport_gpluspy-97"></a>        <span class="k">try</span><span class="p">:</span>
<a name="listingsimport_gpluspy-98"></a>            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_folder</span><span class="p">,</span> <span class="s2">"images"</span><span class="p">))</span>
<a name="listingsimport_gpluspy-99"></a>            <span class="n">LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">"Image folder ceated."</span><span class="p">)</span>
<a name="listingsimport_gpluspy-100"></a>        <span class="k">except</span><span class="p">:</span>
<a name="listingsimport_gpluspy-101"></a>            <span class="k">pass</span>
<a name="listingsimport_gpluspy-102"></a>
<a name="listingsimport_gpluspy-103"></a>        <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">dirs</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">export_folder</span><span class="p">,</span> <span class="n">gto_root</span><span class="p">)):</span>
<a name="listingsimport_gpluspy-104"></a>            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
<a name="listingsimport_gpluspy-105"></a>                <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">".jpg"</span><span class="p">)</span> <span class="ow">or</span> <span class="n">f</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">".jpeg"</span><span class="p">)</span> <span class="ow">or</span> <span class="n">f</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">".png"</span><span class="p">):</span>
<a name="listingsimport_gpluspy-106"></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_folder</span><span class="p">,</span> <span class="s2">"images"</span><span class="p">,</span><span class="n">f</span><span class="p">)):</span>
<a name="listingsimport_gpluspy-107"></a>                        <span class="n">shutil</span><span class="o">.</span><span class="n">copy2</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">f</span><span class="p">),</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_folder</span><span class="p">,</span> <span class="s2">"images"</span><span class="p">))</span>
<a name="listingsimport_gpluspy-108"></a>                        <span class="n">LOGGER</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">"{} copied to Nikola image folder."</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">f</span><span class="p">))</span>
<a name="listingsimport_gpluspy-109"></a>        
<a name="listingsimport_gpluspy-110"></a>    <span class="nd">@staticmethod</span>
<a name="listingsimport_gpluspy-111"></a>    <span class="k">def</span> <span class="nf">populate_context</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">names</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
<a name="listingsimport_gpluspy-112"></a>        <span class="c1"># We don't get much data here</span>
<a name="listingsimport_gpluspy-113"></a>        <span class="n">context</span> <span class="o">=</span> <span class="n">SAMPLE_CONF</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a name="listingsimport_gpluspy-114"></a>        <span class="n">context</span><span class="p">[</span><span class="s1">'DEFAULT_LANG'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'de'</span>
<a name="listingsimport_gpluspy-115"></a>        <span class="n">context</span><span class="p">[</span><span class="s1">'BLOG_DESCRIPTION'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">''</span>
<a name="listingsimport_gpluspy-116"></a>        <span class="n">context</span><span class="p">[</span><span class="s1">'SITE_URL'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'http://localhost:8000/'</span>
<a name="listingsimport_gpluspy-117"></a>        <span class="n">context</span><span class="p">[</span><span class="s1">'BLOG_EMAIL'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">''</span>
<a name="listingsimport_gpluspy-118"></a>        <span class="n">context</span><span class="p">[</span><span class="s1">'BLOG_TITLE'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"Static G+ stream archive"</span>
<a name="listingsimport_gpluspy-119"></a>
<a name="listingsimport_gpluspy-120"></a>        <span class="c1"># Get any random post, all have the same data</span>
<a name="listingsimport_gpluspy-121"></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">names</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a name="listingsimport_gpluspy-122"></a>            <span class="n">soup</span> <span class="o">=</span> <span class="n">bs4</span><span class="o">.</span><span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s2">"html.parser"</span><span class="p">)</span>
<a name="listingsimport_gpluspy-123"></a>            <span class="n">context</span><span class="p">[</span><span class="s1">'BLOG_AUTHOR'</span><span class="p">]</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">"a"</span><span class="p">,</span> <span class="s2">"author"</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
<a name="listingsimport_gpluspy-124"></a>
<a name="listingsimport_gpluspy-125"></a>        <span class="n">context</span><span class="p">[</span><span class="s1">'POSTS'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'''(</span>
<a name="listingsimport_gpluspy-126"></a><span class="s1">            ("posts/*.html", "posts", "post.tmpl"),</span>
<a name="listingsimport_gpluspy-127"></a><span class="s1">            ("posts/*.rst", "posts", "post.tmpl"),</span>
<a name="listingsimport_gpluspy-128"></a><span class="s1">        )'''</span>
<a name="listingsimport_gpluspy-129"></a>        <span class="n">context</span><span class="p">[</span><span class="s1">'COMPILERS'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'''{</span>
<a name="listingsimport_gpluspy-130"></a><span class="s1">        "rest": ('.txt', '.rst'),</span>
<a name="listingsimport_gpluspy-131"></a><span class="s1">        "html": ('.html', '.htm')</span>
<a name="listingsimport_gpluspy-132"></a><span class="s1">        }</span>
<a name="listingsimport_gpluspy-133"></a><span class="s1">        '''</span>
<a name="listingsimport_gpluspy-134"></a>        <span class="k">return</span> <span class="n">context</span>
<a name="listingsimport_gpluspy-135"></a>
<a name="listingsimport_gpluspy-136"></a>    <span class="k">def</span> <span class="nf">import_posts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">folder</span><span class="p">,</span> <span class="n">names</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
<a name="listingsimport_gpluspy-137"></a>        <span class="sd">"""Import all posts."""</span>
<a name="listingsimport_gpluspy-138"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">out_folder</span> <span class="o">=</span> <span class="s1">'posts'</span>
<a name="listingsimport_gpluspy-139"></a>
<a name="listingsimport_gpluspy-140"></a>        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
<a name="listingsimport_gpluspy-141"></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">name</span><span class="p">))</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a name="listingsimport_gpluspy-142"></a>                <span class="n">soup</span> <span class="o">=</span> <span class="n">bs4</span><span class="o">.</span><span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s2">"html.parser"</span><span class="p">)</span>
<a name="listingsimport_gpluspy-143"></a>                
<a name="listingsimport_gpluspy-144"></a>                <span class="n">description</span> <span class="o">=</span> <span class="s2">""</span>
<a name="listingsimport_gpluspy-145"></a>                <span class="n">tags</span> <span class="o">=</span> <span class="p">[]</span>
<a name="listingsimport_gpluspy-146"></a>                
<a name="listingsimport_gpluspy-147"></a>                <span class="n">title_string</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">soup</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">string</span><span class="p">)</span>
<a name="listingsimport_gpluspy-148"></a>                <span class="n">title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prettify_title</span><span class="p">(</span><span class="n">title_string</span><span class="p">)</span>
<a name="listingsimport_gpluspy-149"></a>                
<a name="listingsimport_gpluspy-150"></a>                <span class="c1"># post date is the 2nd link on the page</span>
<a name="listingsimport_gpluspy-151"></a>                <span class="n">post_date</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s2">"a"</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span>
<a name="listingsimport_gpluspy-152"></a>                
<a name="listingsimport_gpluspy-153"></a>                <span class="c1"># collect complete post content</span>
<a name="listingsimport_gpluspy-154"></a>                <span class="n">post_text</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">"div"</span><span class="p">,</span> <span class="s2">"main-content"</span><span class="p">)</span>
<a name="listingsimport_gpluspy-155"></a>                <span class="n">link_embed</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">"a"</span><span class="p">,</span> <span class="s2">"link-embed"</span><span class="p">)</span>
<a name="listingsimport_gpluspy-156"></a>                <span class="n">media_link</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s2">"a"</span><span class="p">,</span> <span class="s2">"media-link"</span><span class="p">)</span>
<a name="listingsimport_gpluspy-157"></a>                <span class="n">album</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">"div"</span><span class="p">,</span> <span class="s2">"album"</span><span class="p">)</span>
<a name="listingsimport_gpluspy-158"></a>                <span class="n">video</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">"div"</span><span class="p">,</span> <span class="s2">"video-placeholder"</span><span class="p">)</span>
<a name="listingsimport_gpluspy-159"></a>                <span class="n">visibility</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">"div"</span><span class="p">,</span> <span class="s2">"visibility"</span><span class="p">)</span>
<a name="listingsimport_gpluspy-160"></a>                <span class="n">activity</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">"div"</span><span class="p">,</span> <span class="s2">"post-activity"</span><span class="p">)</span>
<a name="listingsimport_gpluspy-161"></a>                <span class="n">comments</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">"div"</span><span class="p">,</span> <span class="s2">"comments"</span><span class="p">)</span>
<a name="listingsimport_gpluspy-162"></a>                
<a name="listingsimport_gpluspy-163"></a>                <span class="k">if</span> <span class="n">video</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
<a name="listingsimport_gpluspy-164"></a>                    <span class="n">tags</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"video"</span><span class="p">)</span>
<a name="listingsimport_gpluspy-165"></a>                
<a name="listingsimport_gpluspy-166"></a>                <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">media_link</span><span class="p">:</span>
<a name="listingsimport_gpluspy-167"></a>                    <span class="c1"># link to image in image folder if not external link</span>
<a name="listingsimport_gpluspy-168"></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">link</span><span class="p">[</span><span class="s2">"href"</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">"http"</span><span class="p">):</span>
<a name="listingsimport_gpluspy-169"></a>                        <span class="n">filename</span> <span class="o">=</span> <span class="n">link</span><span class="p">[</span><span class="s2">"href"</span><span class="p">]</span>
<a name="listingsimport_gpluspy-170"></a>                        <span class="k">try</span><span class="p">:</span>
<a name="listingsimport_gpluspy-171"></a>                            <span class="n">link</span><span class="p">[</span><span class="s2">"href"</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">".."</span><span class="p">,</span> <span class="s2">"images"</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
<a name="listingsimport_gpluspy-172"></a>                            <span class="n">tags</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"photo"</span><span class="p">)</span>
<a name="listingsimport_gpluspy-173"></a>                        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
<a name="listingsimport_gpluspy-174"></a>                            <span class="n">LOGGER</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">"No href attribute to convert link destination ({})"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">link</span><span class="p">))</span>
<a name="listingsimport_gpluspy-175"></a>                        <span class="k">try</span><span class="p">:</span>
<a name="listingsimport_gpluspy-176"></a>                            <span class="n">link</span><span class="o">.</span><span class="n">img</span><span class="p">[</span><span class="s2">"src"</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">".."</span><span class="p">,</span> <span class="s2">"images"</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
<a name="listingsimport_gpluspy-177"></a>                        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
<a name="listingsimport_gpluspy-178"></a>                            <span class="n">LOGGER</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">"No src attribute to convert link destination ({})"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">link</span><span class="p">))</span>
<a name="listingsimport_gpluspy-179"></a>                    <span class="c1"># throw away redundant p tag filled with the post text</span>
<a name="listingsimport_gpluspy-180"></a>                    <span class="k">try</span><span class="p">:</span>
<a name="listingsimport_gpluspy-181"></a>                        <span class="n">link</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">decompose</span><span class="p">()</span>
<a name="listingsimport_gpluspy-182"></a>                    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
<a name="listingsimport_gpluspy-183"></a>                        <span class="k">pass</span>
<a name="listingsimport_gpluspy-184"></a>                
<a name="listingsimport_gpluspy-185"></a>                <span class="c1"># multiple entries only in albums, so we only need first item</span>
<a name="listingsimport_gpluspy-186"></a>                <span class="c1"># BeautifulSoup.find_all() always returns result, so media_link</span>
<a name="listingsimport_gpluspy-187"></a>                <span class="c1"># is never None</span>
<a name="listingsimport_gpluspy-188"></a>                <span class="k">try</span><span class="p">:</span>
<a name="listingsimport_gpluspy-189"></a>                    <span class="n">media_link</span> <span class="o">=</span> <span class="n">media_link</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a name="listingsimport_gpluspy-190"></a>                <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
<a name="listingsimport_gpluspy-191"></a>                    <span class="n">media_link</span> <span class="o">=</span> <span class="bp">None</span>
<a name="listingsimport_gpluspy-192"></a>                
<a name="listingsimport_gpluspy-193"></a>                <span class="k">if</span> <span class="n">album</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
<a name="listingsimport_gpluspy-194"></a>                    <span class="n">tags</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"photo_album"</span><span class="p">)</span>
<a name="listingsimport_gpluspy-195"></a>                    <span class="c1"># we don't need media_link if album is available</span>
<a name="listingsimport_gpluspy-196"></a>                    <span class="n">media_link</span> <span class="o">=</span> <span class="bp">None</span>
<a name="listingsimport_gpluspy-197"></a>                
<a name="listingsimport_gpluspy-198"></a>                <span class="k">if</span> <span class="n">link_embed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
<a name="listingsimport_gpluspy-199"></a>                    <span class="n">tags</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"link"</span><span class="p">)</span>
<a name="listingsimport_gpluspy-200"></a>                    <span class="c1"># we don't need media_link if we got external link</span>
<a name="listingsimport_gpluspy-201"></a>                    <span class="n">media_link</span> <span class="o">=</span> <span class="bp">None</span>
<a name="listingsimport_gpluspy-202"></a>                
<a name="listingsimport_gpluspy-203"></a>                <span class="n">content</span> <span class="o">=</span> <span class="s2">""</span>
<a name="listingsimport_gpluspy-204"></a>                <span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="p">[</span><span class="n">post_text</span><span class="p">,</span>
<a name="listingsimport_gpluspy-205"></a>                             <span class="n">link_embed</span><span class="p">,</span>
<a name="listingsimport_gpluspy-206"></a>                             <span class="n">album</span><span class="p">,</span>
<a name="listingsimport_gpluspy-207"></a>                             <span class="n">media_link</span><span class="p">,</span>
<a name="listingsimport_gpluspy-208"></a>                             <span class="n">visibility</span><span class="p">,</span>
<a name="listingsimport_gpluspy-209"></a>                             <span class="n">activity</span><span class="p">,</span>
<a name="listingsimport_gpluspy-210"></a>                             <span class="n">comments</span><span class="p">]:</span>
<a name="listingsimport_gpluspy-211"></a>                    <span class="k">if</span> <span class="n">part</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
<a name="listingsimport_gpluspy-212"></a>                        <span class="n">content</span> <span class="o">=</span> <span class="s2">"{}</span><span class="se">\n</span><span class="s2">{}</span><span class="se">\n</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">part</span><span class="p">)</span>
<a name="listingsimport_gpluspy-213"></a>
<a name="listingsimport_gpluspy-214"></a>                <span class="c1"># receive link from post date</span>
<a name="listingsimport_gpluspy-215"></a>                <span class="n">link</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s2">"a"</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"href"</span><span class="p">)</span>
<a name="listingsimport_gpluspy-216"></a>                
<a name="listingsimport_gpluspy-217"></a>                <span class="n">slug</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">slugify</span><span class="p">(</span><span class="s2">"{}_{}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">post_date</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="n">title</span><span class="p">),</span> <span class="n">lang</span><span class="o">=</span><span class="s2">"de"</span><span class="p">)</span>
<a name="listingsimport_gpluspy-218"></a>                
<a name="listingsimport_gpluspy-219"></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">slug</span><span class="p">:</span>  <span class="c1"># should never happen</span>
<a name="listingsimport_gpluspy-220"></a>                    <span class="n">LOGGER</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">"Error converting post:"</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>
<a name="listingsimport_gpluspy-221"></a>                    <span class="k">return</span>
<a name="listingsimport_gpluspy-222"></a>
<a name="listingsimport_gpluspy-223"></a>                <span class="c1"># additional metadata</span>
<a name="listingsimport_gpluspy-224"></a>                <span class="n">more</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"link"</span><span class="p">:</span> <span class="n">link</span><span class="p">,</span> <span class="c1"># original G+ post</span>
<a name="listingsimport_gpluspy-225"></a>                        <span class="s2">"hidetitle"</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span> <span class="c1"># doesn't work for index pages</span>
<a name="listingsimport_gpluspy-226"></a>                        <span class="p">}</span>
<a name="listingsimport_gpluspy-227"></a>                                
<a name="listingsimport_gpluspy-228"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">write_metadata</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_folder</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_folder</span><span class="p">,</span> <span class="n">slug</span> <span class="o">+</span> <span class="s2">".meta"</span><span class="p">),</span> <span class="n">title</span><span class="p">,</span> <span class="n">slug</span><span class="p">,</span> <span class="n">post_date</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">tags</span><span class="p">,</span> <span class="n">more</span><span class="p">)</span>
<a name="listingsimport_gpluspy-229"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">write_content</span><span class="p">(</span>
<a name="listingsimport_gpluspy-230"></a>                    <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_folder</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_folder</span><span class="p">,</span> <span class="n">slug</span> <span class="o">+</span> <span class="s2">".html"</span><span class="p">),</span>
<a name="listingsimport_gpluspy-231"></a>                    <span class="n">content</span><span class="p">)</span>
<a name="listingsimport_gpluspy-232"></a>
<a name="listingsimport_gpluspy-233"></a>    <span class="k">def</span> <span class="nf">write_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">slug</span><span class="p">,</span> <span class="n">post_date</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">tags</span><span class="p">,</span> <span class="n">more</span><span class="p">):</span>
<a name="listingsimport_gpluspy-234"></a>        <span class="nb">super</span><span class="p">(</span><span class="n">CommandImportGplus</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">write_metadata</span><span class="p">(</span>
<a name="listingsimport_gpluspy-235"></a>            <span class="n">filename</span><span class="p">,</span>
<a name="listingsimport_gpluspy-236"></a>            <span class="n">title</span><span class="p">,</span>
<a name="listingsimport_gpluspy-237"></a>            <span class="n">slug</span><span class="p">,</span>
<a name="listingsimport_gpluspy-238"></a>            <span class="n">post_date</span><span class="p">,</span>
<a name="listingsimport_gpluspy-239"></a>            <span class="n">description</span><span class="p">,</span>
<a name="listingsimport_gpluspy-240"></a>            <span class="n">tags</span><span class="p">,</span>
<a name="listingsimport_gpluspy-241"></a>            <span class="o">**</span><span class="n">more</span>
<a name="listingsimport_gpluspy-242"></a>            <span class="p">)</span>
<a name="listingsimport_gpluspy-243"></a>
<a name="listingsimport_gpluspy-244"></a>    <span class="k">def</span> <span class="nf">prettify_title</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
<a name="listingsimport_gpluspy-245"></a>        <span class="sd">"""</span>
<a name="listingsimport_gpluspy-246"></a><span class="sd">            Titles are generated from post text.</span>
<a name="listingsimport_gpluspy-247"></a><span class="sd">            Cut junk and shorten to one line</span>
<a name="listingsimport_gpluspy-248"></a><span class="sd">            for readability and convenience.</span>
<a name="listingsimport_gpluspy-249"></a><span class="sd">        """</span>
<a name="listingsimport_gpluspy-250"></a>        <span class="c1"># reduce title string to one line</span>
<a name="listingsimport_gpluspy-251"></a>        <span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">"&lt;br&gt;"</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<a name="listingsimport_gpluspy-252"></a>        <span class="c1"># link in title? just cut it out, ain't nobody got time for that</span>
<a name="listingsimport_gpluspy-253"></a>        <span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">"&lt;a "</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<a name="listingsimport_gpluspy-254"></a>        <span class="c1"># same for user link</span>
<a name="listingsimport_gpluspy-255"></a>        <span class="n">t</span><span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">"span class="</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<a name="listingsimport_gpluspy-256"></a>        <span class="c1"># cut trailing dots</span>
<a name="listingsimport_gpluspy-257"></a>        <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">"..."</span><span class="p">):</span>
<a name="listingsimport_gpluspy-258"></a>            <span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span>
<a name="listingsimport_gpluspy-259"></a>        <span class="c1"># cut html elements and fix quotation marks</span>
<a name="listingsimport_gpluspy-260"></a>        <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="p">[(</span><span class="s2">"&lt;b&gt;"</span><span class="p">,</span> <span class="s2">""</span><span class="p">),</span>
<a name="listingsimport_gpluspy-261"></a>                     <span class="p">(</span><span class="s2">"&lt;/b&gt;"</span><span class="p">,</span> <span class="s2">""</span><span class="p">),</span>
<a name="listingsimport_gpluspy-262"></a>                     <span class="p">(</span><span class="s2">"&amp;quot;"</span><span class="p">,</span> <span class="s2">"</span><span class="se">\"</span><span class="s2">"</span><span class="p">),</span>
<a name="listingsimport_gpluspy-263"></a>                     <span class="p">(</span><span class="s2">"&amp;#39;"</span><span class="p">,</span> <span class="s2">"'"</span><span class="p">),</span>
<a name="listingsimport_gpluspy-264"></a>                     <span class="p">(</span><span class="s2">"&lt;b"</span><span class="p">,</span> <span class="s2">""</span><span class="p">),</span>
<a name="listingsimport_gpluspy-265"></a>                     <span class="p">(</span><span class="s2">"&lt;/"</span><span class="p">,</span> <span class="s2">""</span><span class="p">),</span>
<a name="listingsimport_gpluspy-266"></a>                     <span class="p">(</span><span class="s2">"&lt;i&gt;"</span><span class="p">,</span> <span class="s2">""</span><span class="p">),</span>
<a name="listingsimport_gpluspy-267"></a>                     <span class="p">(</span><span class="s2">"&lt;/i&gt;"</span><span class="p">,</span> <span class="s2">""</span><span class="p">),</span>
<a name="listingsimport_gpluspy-268"></a>                     <span class="p">(</span><span class="s2">"&lt;"</span><span class="p">,</span> <span class="s2">""</span><span class="p">),]:</span>
<a name="listingsimport_gpluspy-269"></a>            <span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">tag</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">tag</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<a name="listingsimport_gpluspy-270"></a>        
<a name="listingsimport_gpluspy-271"></a>        <span class="k">return</span> <span class="n">t</span>
</pre></td>
</tr></table>
</div>
    
    
                <script src="../assets/js/all-nocdn.js" type="text/javascript"></script><!-- fancy dates --><script>
      moment.locale("de");
      fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates -->
</body>
</html>
